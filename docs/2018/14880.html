<!DOCTYPE html>
<html lang=en>
           <head>
            <meta charset=UTF-8>
            <title>File opened already by someone</title>
            <meta name=viewport
                  content="width=device-width, initial-scale=1.0">
            <link rel=stylesheet
                  href=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css
                  integrity=sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2
                  crossorigin=anonymous>
            <style>
section.tree {
    padding-left: 2em;
}
section.tree:first-child {
    padding-left: 0;
}
.article-link {
  margin-bottom: 1em;
}
</style>
<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9X3G9MMWZP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9X3G9MMWZP');
</script>

           </head>
           <body>
            <header class="d-flex justify-content-center">
             <nav
                  class="navbar navbar-light bg-light w-100 mx-5 mb-3">
              <a class=navbar-brand href="/">Lisp HUG Maillist Archive</a>
             </nav>
            </header>
            <div class="d-flex justify-content-center">
             <div class="w-100 mx-5 px-3">
              <section class=tree>
               <article class=email>
                <h1>File opened already by someone</h1><html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" xmlns="http://www.w3.org/TR/REC-html40">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<meta name="Generator" content="Microsoft Word 15 (filtered medium)">
<style><!--
/* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-fareast-language:EN-US;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:#0563C1;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:#954F72;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri",sans-serif;
	color:windowtext;}
..MsoChpDefault
	{mso-style-type:export-only;
	font-family:"Calibri",sans-serif;
	mso-fareast-language:EN-US;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:70.85pt 2.0cm 70.85pt 2.0cm;}
div.WordSection1
	{page:WordSection1;}
--></style><!--[if gte mso 9]><xml>
<o:shapedefaults v:ext="edit" spidmax="1026" />
</xml><![endif]--><!--[if gte mso 9]><xml>
<o:shapelayout v:ext="edit">
<o:idmap v:ext="edit" data="1" />
</o:shapelayout></xml><![endif]-->
</head>
<body lang="EN-GB" link="#0563C1" vlink="#954F72">
<div class="WordSection1">
<p class="MsoNormal">Hi, <o:p></o:p></p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal">I&#8217;m pondering this one topic. <o:p></o:p></p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal">So, let&#8217;s say that we have a network drive and several different users may access the same files. This would happen on MS Windows.
<o:p></o:p></p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal">If the file being opened would be, let&#8217;s say, a MS Word document, then other individuals opening the same file would get a message that the file has already been opened by someone and it can only be opened in read-only mode.
<o:p></o:p></p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal">What I&#8217;m asking is that would someone have some experience on building a similar kind of system with Common Lisp?
<o:p></o:p></p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal">There are answers e.g. <a href="https://stackoverflow.com/questions/876473/is-there-a-way-to-check-if-a-file-is-in-use">
https://stackoverflow.com/questions/876473/is-there-a-way-to-check-if-a-file-is-in-use</a>, but as it is typical, it&#8217;s difficult to find answers that address Common Lisp directly.
<o:p></o:p></p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal">I think that one may need to define a specific foreing function for testing the properties of the file in question. (Didn&#8217;t yet see anything suitable in the win32 package.)
<o:p></o:p></p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal">I&#8217;m quite sure that making this kind of a feature is possible. Any experiences or tips would be appreciated.
<o:p></o:p></p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal">With Best Regards, <o:p></o:p></p>
<p class="MsoNormal">Teemu Liikala <o:p></o:p></p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;mso-fareast-language:EN-GB">Teemu Liikala<br>
Associate, Dynamic Simulation, NAPCON<br>
</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:black;mso-fareast-language:EN-GB">Neste Engineering Solutions Oy</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;mso-fareast-language:EN-GB"><br>
P.O. Box 310, FI-06101 Porvoo, Finland<br>
Visiting address: </span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;mso-fareast-language:EN-GB">Teknologiantie 36, Kilpilahti, 06850 Kulloo</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;mso-fareast-language:EN-GB"><br>
Tel. &#43;358 50 458 2280<br>
<u>teemu.liikala@neste.com<br>
</u></span><u><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:black;mso-fareast-language:EN-GB">www.napconsuite.com</span></u><u><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;mso-fareast-language:EN-GB"><br>
www.neste.com</span></u><span style="mso-fareast-language:EN-GB"><o:p></o:p></span></p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
</div>
</body>
</html>


               </article>
               <section class=tree>
                <article class=email>
                 <h1>Re: File opened already by someone</h1><div dir="ltr"><div><div><div>Hi,<br><br></div>I would write first the Win32 C code to test the approach, and then port the code to FFI/Common Lisp.<br><br></div>BR<br></div>/Alexey<br></div><br><div class="gmail_quote"><div dir="ltr">On Thu, Oct 25, 2018 at 9:56 AM Liikala Teemu &lt;<a href="mailto:Teemu.Liikala@neste.com">Teemu.Liikala@neste.com</a>&gt; wrote:<br></div><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">





<div lang="EN-GB" link="#0563C1" vlink="#954F72">
<div class="m_-2626284846887483340WordSection1">
<p class="MsoNormal">Hi, <u></u><u></u></p>
<p class="MsoNormal"><u></u> <u></u></p>
<p class="MsoNormal">I’m pondering this one topic. <u></u><u></u></p>
<p class="MsoNormal"><u></u> <u></u></p>
<p class="MsoNormal">So, let’s say that we have a network drive and several different users may access the same files. This would happen on MS Windows.
<u></u><u></u></p>
<p class="MsoNormal"><u></u> <u></u></p>
<p class="MsoNormal">If the file being opened would be, let’s say, a MS Word document, then other individuals opening the same file would get a message that the file has already been opened by someone and it can only be opened in read-only mode.
<u></u><u></u></p>
<p class="MsoNormal"><u></u> <u></u></p>
<p class="MsoNormal">What I’m asking is that would someone have some experience on building a similar kind of system with Common Lisp?
<u></u><u></u></p>
<p class="MsoNormal"><u></u> <u></u></p>
<p class="MsoNormal">There are answers e.g. <a href="https://stackoverflow.com/questions/876473/is-there-a-way-to-check-if-a-file-is-in-use" target="_blank">
https://stackoverflow.com/questions/876473/is-there-a-way-to-check-if-a-file-is-in-use</a>, but as it is typical, it’s difficult to find answers that address Common Lisp directly.
<u></u><u></u></p>
<p class="MsoNormal"><u></u> <u></u></p>
<p class="MsoNormal">I think that one may need to define a specific foreing function for testing the properties of the file in question. (Didn’t yet see anything suitable in the win32 package.)
<u></u><u></u></p>
<p class="MsoNormal"><u></u> <u></u></p>
<p class="MsoNormal">I’m quite sure that making this kind of a feature is possible. Any experiences or tips would be appreciated.
<u></u><u></u></p>
<p class="MsoNormal"><u></u> <u></u></p>
<p class="MsoNormal">With Best Regards, <u></u><u></u></p>
<p class="MsoNormal">Teemu Liikala <u></u><u></u></p>
<p class="MsoNormal"><u></u> <u></u></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif">Teemu Liikala<br>
Associate, Dynamic Simulation, NAPCON<br>
</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:black">Neste Engineering Solutions Oy</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif"><br>
P.O. Box 310, FI-06101 Porvoo, Finland<br>
Visiting address: </span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif">Teknologiantie 36, Kilpilahti, 06850 Kulloo</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif"><br>
Tel. +358 50 458 2280<br>
<u><a href="mailto:teemu.liikala@neste.com" target="_blank">teemu.liikala@neste.com</a><br>
</u></span><u><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:black"><a href="http://www.napconsuite.com" target="_blank">www.napconsuite.com</a></span></u><u><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif"><br>
<a href="http://www.neste.com" target="_blank">www.neste.com</a></span></u><span><u></u><u></u></span></p>
<p class="MsoNormal"><u></u> <u></u></p>
</div>
</div>

</blockquote></div>


                </article>
               </section>
               <section class=tree>
                <article class=email>
                 <h1>RE: File opened already by someone</h1><html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" xmlns="http://www.w3.org/TR/REC-html40">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="Generator" content="Microsoft Word 15 (filtered medium)">
<style><!--
/* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
p.msonormal0, li.msonormal0, div.msonormal0
	{mso-style-name:msonormal;
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
span.EmailStyle18
	{mso-style-type:personal;
	font-family:"Times New Roman",serif;
	color:windowtext;
	font-weight:normal;
	font-style:normal;}
span.EmailStyle19
	{mso-style-type:personal-reply;
	font-family:"Calibri",sans-serif;
	color:#1F497D;}
.MsoChpDefault
	{mso-style-type:export-only;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.WordSection1
	{page:WordSection1;}
--></style><!--[if gte mso 9]><xml>
<o:shapedefaults v:ext="edit" spidmax="1026" />
</xml><![endif]--><!--[if gte mso 9]><xml>
<o:shapelayout v:ext="edit">
<o:idmap v:ext="edit" data="1" />
</o:shapelayout></xml><![endif]-->
</head>
<body lang="EN-GB" link="blue" vlink="purple">
<div class="WordSection1">
<p class="MsoNormal"><span style="color:#1F497D;mso-fareast-language:EN-US">Hi, <o:p>
</o:p></span></p>
<p class="MsoNormal"><span style="color:#1F497D;mso-fareast-language:EN-US"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span style="color:#1F497D;mso-fareast-language:EN-US">Thank you for the tips!
<o:p></o:p></span></p>
<p class="MsoNormal"><span style="color:#1F497D;mso-fareast-language:EN-US"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span style="color:#1F497D;mso-fareast-language:EN-US">Trying to rename the file with same name under handler-case seems easy, doable and fast.
<o:p></o:p></span></p>
<p class="MsoNormal"><span style="color:#1F497D;mso-fareast-language:EN-US"><o:p>&nbsp;</o:p></span></p>
<div>
<p class="MsoNormal"><span lang="FI" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:#1F497D">With Best Regards,
<o:p></o:p></span></p>
<p class="MsoNormal"><span lang="FI" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:#1F497D">Teemu
<o:p></o:p></span></p>
</div>
<p class="MsoNormal"><span style="color:#1F497D;mso-fareast-language:EN-US"><o:p>&nbsp;</o:p></span></p>
<div>
<div style="border:none;border-top:solid #E1E1E1 1.0pt;padding:3.0pt 0cm 0cm 0cm">
<p class="MsoNormal"><b><span lang="EN-US">From:</span></b><span lang="EN-US"> owner-lisp-hug@lispworks.com [mailto:owner-lisp-hug@lispworks.com]
<b>On Behalf Of </b>Ron Lewis<br>
<b>Sent:</b> torstai 25. lokakuuta 2018 20.25<br>
<b>To:</b> 'Lispworks HUG' &lt;lisp-hug@lispworks.com&gt;<br>
<b>Subject:</b> RE: File opened already by someone<o:p></o:p></span></p>
</div>
</div>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif">This is an interesting problem. I am thinking how this might be handled. Here is what I am thinking:<o:p></o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif">APPROACH 1, FLI<o:p></o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif">Use Create functions such as CreateFileA() or CreateFileW() to open the file, even though an old file is being opened.<o:p></o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif">Use CloseHandle() to close the file.<o:p></o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif">(See
<a href="https://docs.microsoft.com/en-us/windows/desktop/api/fileapi/">https://docs.microsoft.com/en-us/windows/desktop/api/fileapi/</a>)<o:p></o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif">Header files &lt;Fileapi.h&gt; or &lt;Windows.h&gt;<o:p></o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif">I think this means all file I/O is done outside of Lisp. So, you also need API functions to read and write the files.<o:p></o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif">APPROACH 2, All in Lisp, No C, No FLI<o:p></o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif">I think you could use (rename) and (handler-case) to get the effects you want.<o:p></o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif">An app wanting to open a file for possible modification would rename the file, then open. When a second app tries to open the same file, the file will not be
 there. So the second app’s rename will cause an error. You catch this error using (handler-case) and tell the user that the file is temporarily not available or whatever you want to do. When the first app is done, the app renames the file back so that it is
 available to the other apps.<o:p></o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif">If two apps are trying to rename the file at the same time (a race condition) the operating system will only let one of them succeed, the other one gets the
 error. So, I think race conditions are handled automatically.<o:p></o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif">If you want the file to be available for read-only, you could have a copy of the file.<o:p></o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif">I am just thinking, but I have not tried this.<o:p></o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif">For catching and handling errors with (handler-case), I am looking at 9.1.4 of Common Lisp HyperSpec.<o:p></o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><i><span lang="EN-US" style="font-family:&quot;Times New Roman&quot;,serif">Ron Lewis<o:p></o:p></span></i></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:&quot;Times New Roman&quot;,serif">5719 Narcissus Avenue<o:p></o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:&quot;Times New Roman&quot;,serif">Baltimore, MD 21215-3551<o:p></o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,serif"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><b><span lang="EN-US">From:</span></b><span lang="EN-US"> <a href="mailto:owner-lisp-hug@lispworks.com">
owner-lisp-hug@lispworks.com</a> &lt;<a href="mailto:owner-lisp-hug@lispworks.com">owner-lisp-hug@lispworks.com</a>&gt;
<b>On Behalf Of </b>Alexey Veretennikov<br>
<b>Sent:</b> Thursday, October 25, 2018 7:13 AM<br>
<b>To:</b> <a href="mailto:Teemu.Liikala@neste.com">Teemu.Liikala@neste.com</a><br>
<b>Cc:</b> Lispworks HUG &lt;<a href="mailto:lisp-hug@lispworks.com">lisp-hug@lispworks.com</a>&gt;<br>
<b>Subject:</b> Re: File opened already by someone<o:p></o:p></span></p>
<p class="MsoNormal"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>
<div>
<div>
<div>
<div>
<p class="MsoNormal" style="margin-bottom:12.0pt"><span lang="EN-US">Hi,<o:p></o:p></span></p>
</div>
<p class="MsoNormal" style="margin-bottom:12.0pt"><span lang="EN-US">I would write first the Win32 C code to test the approach, and then port the code to FFI/Common Lisp.<o:p></o:p></span></p>
</div>
<p class="MsoNormal"><span lang="EN-US">BR<o:p></o:p></span></p>
</div>
<p class="MsoNormal"><span lang="EN-US">/Alexey<o:p></o:p></span></p>
</div>
<p class="MsoNormal"><span lang="EN-US"><o:p>&nbsp;</o:p></span></p>
<div>
<div>
<p class="MsoNormal"><span lang="EN-US">On Thu, Oct 25, 2018 at 9:56 AM Liikala Teemu &lt;<a href="mailto:Teemu.Liikala@neste.com">Teemu.Liikala@neste.com</a>&gt; wrote:<o:p></o:p></span></p>
</div>
<blockquote style="border:none;border-left:solid #CCCCCC 1.0pt;padding:0cm 0cm 0cm 6.0pt;margin-left:4.8pt;margin-top:5.0pt;margin-right:0cm;margin-bottom:5.0pt">
<div>
<div>
<p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto">Hi,
<o:p></o:p></p>
<p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto">&nbsp;<o:p></o:p></p>
<p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto">I’m pondering this one topic.
<o:p></o:p></p>
<p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto">&nbsp;<o:p></o:p></p>
<p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto">So, let’s say that we have a network drive and several different users may access the same files. This would happen on MS Windows.
<o:p></o:p></p>
<p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto">&nbsp;<o:p></o:p></p>
<p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto">If the file being opened would be, let’s say, a MS Word document, then other individuals opening the same file would get a message that the file has already been opened by someone
 and it can only be opened in read-only mode. <o:p></o:p></p>
<p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto">&nbsp;<o:p></o:p></p>
<p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto">What I’m asking is that would someone have some experience on building a similar kind of system with Common Lisp?
<o:p></o:p></p>
<p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto">&nbsp;<o:p></o:p></p>
<p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto">There are answers e.g.
<a href="https://stackoverflow.com/questions/876473/is-there-a-way-to-check-if-a-file-is-in-use" target="_blank">
https://stackoverflow.com/questions/876473/is-there-a-way-to-check-if-a-file-is-in-use</a>, but as it is typical, it’s difficult to find answers that address Common Lisp directly.
<o:p></o:p></p>
<p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto">&nbsp;<o:p></o:p></p>
<p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto">I think that one may need to define a specific foreing function for testing the properties of the file in question. (Didn’t yet see anything suitable in the win32 package.)
<o:p></o:p></p>
<p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto">&nbsp;<o:p></o:p></p>
<p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto">I’m quite sure that making this kind of a feature is possible. Any experiences or tips would be appreciated.
<o:p></o:p></p>
<p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto">&nbsp;<o:p></o:p></p>
<p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto">With Best Regards,
<o:p></o:p></p>
<p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto">Teemu Liikala
<o:p></o:p></p>
<p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto">&nbsp;<o:p></o:p></p>
<p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto"><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif">Teemu Liikala<br>
Associate, Dynamic Simulation, NAPCON<br>
</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:black">Neste Engineering Solutions Oy</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif"><br>
P.O. Box 310, FI-06101 Porvoo, Finland<br>
Visiting address: </span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif">Teknologiantie 36, Kilpilahti, 06850 Kulloo</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif"><br>
Tel. &#43;358 50 458 2280<br>
<u><a href="mailto:teemu.liikala@neste.com" target="_blank">teemu.liikala@neste.com</a><br>
</u></span><u><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:black"><a href="http://www.napconsuite.com" target="_blank">www.napconsuite.com</a></span></u><u><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif"><br>
<a href="http://www.neste.com" target="_blank">www.neste.com</a></span></u><o:p></o:p></p>
<p class="MsoNormal" style="mso-margin-top-alt:auto;mso-margin-bottom-alt:auto">&nbsp;<o:p></o:p></p>
</div>
</div>
</blockquote>
</div>
</div>
</body>
</html>

                </article>
               </section>
               <section class=tree>
                <article class=email>
                 <h1>Re: File opened already by someone</h1><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"></head><body dir="auto"><div dir="ltr"></div><div dir="ltr">File (and general resource) contention is a huge area. &nbsp;Almost certainly you will be better off interfacing to whatever facilities the OS provides than trying to reinvent them yourself I think.</div><div dir="ltr"><br>On 25 Oct 2018, at 08:55, Liikala Teemu &lt;<a href="mailto:Teemu.Liikala@neste.com">Teemu.Liikala@neste.com</a>&gt; wrote:<br><br></div><blockquote type="cite"><div dir="ltr">

<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<meta name="Generator" content="Microsoft Word 15 (filtered medium)">
<style><!--
/* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-fareast-language:EN-US;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:#0563C1;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:#954F72;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri",sans-serif;
	color:windowtext;}
..MsoChpDefault
	{mso-style-type:export-only;
	font-family:"Calibri",sans-serif;
	mso-fareast-language:EN-US;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:70.85pt 2.0cm 70.85pt 2.0cm;}
div.WordSection1
	{page:WordSection1;}
--></style><!--[if gte mso 9]><xml>
<o:shapedefaults v:ext="edit" spidmax="1026" />
</xml><![endif]--><!--[if gte mso 9]><xml>
<o:shapelayout v:ext="edit">
<o:idmap v:ext="edit" data="1" />
</o:shapelayout></xml><![endif]-->


<div class="WordSection1">
<p class="MsoNormal">Hi, <o:p></o:p></p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal">I’m pondering this one topic. <o:p></o:p></p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal">So, let’s say that we have a network drive and several different users may access the same files. This would happen on MS Windows.
<o:p></o:p></p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal">If the file being opened would be, let’s say, a MS Word document, then other individuals opening the same file would get a message that the file has already been opened by someone and it can only be opened in read-only mode.
<o:p></o:p></p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal">What I’m asking is that would someone have some experience on building a similar kind of system with Common Lisp?
<o:p></o:p></p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal">There are answers e.g. <a href="https://stackoverflow.com/questions/876473/is-there-a-way-to-check-if-a-file-is-in-use">
https://stackoverflow.com/questions/876473/is-there-a-way-to-check-if-a-file-is-in-use</a>, but as it is typical, it’s difficult to find answers that address Common Lisp directly.
<o:p></o:p></p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal">I think that one may need to define a specific foreing function for testing the properties of the file in question. (Didn’t yet see anything suitable in the win32 package.)
<o:p></o:p></p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal">I’m quite sure that making this kind of a feature is possible. Any experiences or tips would be appreciated.
<o:p></o:p></p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal">With Best Regards, <o:p></o:p></p>
<p class="MsoNormal">Teemu Liikala <o:p></o:p></p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;mso-fareast-language:EN-GB">Teemu Liikala<br>
Associate, Dynamic Simulation, NAPCON<br>
</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:black;mso-fareast-language:EN-GB">Neste Engineering Solutions Oy</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;mso-fareast-language:EN-GB"><br>
P.O. Box 310, FI-06101 Porvoo, Finland<br>
Visiting address: </span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;mso-fareast-language:EN-GB">Teknologiantie 36, Kilpilahti, 06850 Kulloo</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;mso-fareast-language:EN-GB"><br>
Tel. +358 50 458 2280<br>
<u><a href="mailto:teemu.liikala@neste.com">teemu.liikala@neste.com</a><br>
</u></span><u><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;color:black;mso-fareast-language:EN-GB"><a href="http://www.napconsuite.com">www.napconsuite.com</a></span></u><u><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif;mso-fareast-language:EN-GB"><br>
<a href="http://www.neste.com">www.neste.com</a></span></u><span style="mso-fareast-language:EN-GB"><o:p></o:p></span></p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
</div>


</div></blockquote></body></html>

                </article>
               </section>
              </section>
             </div>
            </div>
            <footer class="d-flex justify-content-center">
             <div>
              Updated at: 2020-12-10 08:29 UTC
             </div>
            </footer>
           </body>
          </html>