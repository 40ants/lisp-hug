<!DOCTYPE html>
<html lang=en>
           <head>
            <meta charset=UTF-8>
            <title>GC problems when using foreign-callable</title>
            <link rel=stylesheet
                  href=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css
                  integrity=sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2
                  crossorigin=anonymous>
            <style>
section.tree {
    padding-left: 2em;
}
section.tree:first-child {
    padding-left: 0;
}
.article-link {
  margin-bottom: 1em;
}
</style>
<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9X3G9MMWZP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9X3G9MMWZP');
</script>

           </head>
           <body>
            <header class="d-flex justify-content-center">
             <nav
                  class="navbar navbar-light bg-light w-100 mx-5 mb-3">
              <a class=navbar-brand href="/">Lisp HUG Maillist Archive</a>
             </nav>
            </header>
            <div class="d-flex justify-content-center">
             <div class="w-100 mx-5 px-3">
              <section class=tree>
               <article class=email>
                <h1>GC problems when using foreign-callable</h1>
                <pre>

I'm getting regular problems with the garbage collector dumping the
stack and exiting.  This happens inside some foreign-callable, which
may be part of the problem.  This is run from a repl on a 64 bit
LispWorks 5.0.1 on a 64-bit Linux.

Any advice or pointers appreciated.

Stack trace below.

Cheers,
Chris Dean


 ** &lt;&lt; SERIOUS PROBLEMS DURING GARBAGE COLLECTION    &gt&gt  **
 SIG = 0xb  PC = 0x40000794f8
eax 0x59584f02  ebx 0x4000077f24 ecx 0x4 edx 0x40700be623
esi 0x40f02ca488  edi 0x544e452d59584f53 esp 0x431e4998 ebp 0x431e49b8
r8 0x544e452d50000000  r9 0x40700be620 r10 0x407 r11  0x431e4a60
r12 0x40f0000000 r13   0x40f02ca488 r14 0x4000049809 r15 0x4000079494
"Simple Backtrace:"
0x431e4970 -&gt 0x4000079494: OTHER-COPIED-SWEEP-FUNC
0x431e49b8 -&gt 0x40000792cc: GENERATION-SCAN-AFTER-COPY
0x431e49f8 -&gt 0x400007fc54: SCAN-AFTER-COPY
0x431e4a30 -&gt 0x400007f9e4: I-DO-GC
0x431e4b28 -&gt 0x400007f844: I-DO-COPYING-GC
0x431e4b60 -&gt 0x4000091d9c: CALL-GCING-FUNCTION
0x404062c380 -&gt 0x40000955b4: CALL-COPYING-GC
0x404062c3a0 -&gt 0x40000952bc: CALL-COPYING-GC-CHECKING
0x404062c3d0 -&gt 0x4000093acc: ALLOCATE-SOME-OTHER-IN-GENERATION
0x404062c410 -&gt 0x41e0281b8c: ALLOCATE-G-VECTOR
0x404062c440 -&gt 0x41e03a9d0c: COPY-STANDARD-INSTANCE
0x404062c478 -&gt 0x41e038ccdc: MAKE-INSTANCE-FROM-CLASS-1
0x404062c4c0 -&gt 0x41e033403c: MAKE-INSTANCE-FROM-CLASS
0x404062c4f0 -&gt 0x4180025f64: (METHOD MAKE-IN-MEMORY-INPUT-STREAM (VECTOR))
0x404062c588 -&gt 0x41e084a1fc: GENERIC-FUNCTION-DISCRIMINATOR
0x404062c5e0 -&gt 0x4180018edc: RESTORE-STORAGE-VECTOR
0x404062c660 -&gt 0x418001902c: (SUBFUNCTION 1 MAKE-BTREE-COMPARATOR)
0x404062c6a0 -&gt 0x4180019194: (SUBFUNCTION %FOREIGN-CALLABLE/db-bt-comparator (DEFINE-FOREIGN-CALLABLE "db-bt-comparator"))
0x404062c708 -&gt 0x400009cf9c: IN-ENTRY-FROM-C
0x404062c7e8 -&gt 0x400009cde4: LISP-ENTRY-FROM-C
0x431e4ba0 -&gt 0x40e001719c: NIL
Stack dump
0x00000000431e4998  0x0000000000000008 0x00000040f02ca478 0x00000040f02cb090 0x00000040f0f70000
0x00000000431e49b8  0x00000000431e49f8 0x00000040000792cc 0x0000004000049809 0x0000000000000008
0x00000000431e49d8  0x00000000431e4a60 0x000000400007934a 0x000000400004b3f8 0x0000000000000018
0x00000000431e49f8  0x00000000431e4a30 0x000000400007fc54 0x0000004000049809 0x00000000431e4a60

Process inferior-lisp exited abnormally with code 210


</pre>
               </article>
              </section>
             </div>
            </div>
            <footer class="d-flex justify-content-center">
             <div>
              Updated at: 2020-12-07 08:43 UTC
             </div>
            </footer>
           </body>
          </html>