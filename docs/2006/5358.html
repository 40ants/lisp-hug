<!DOCTYPE html>
<html lang=en>
           <head>
            <meta charset=UTF-8>
            <title>File "macros/specmac" and delivery on Linux</title>
            <link rel=stylesheet
                  href=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css
                  integrity=sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2
                  crossorigin=anonymous>
            <style>
section.tree {
    padding-left: 2em;
}
section.tree:first-child {
    padding-left: 0;
}
.article-link {
  margin-bottom: 1em;
}
</style>
<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9X3G9MMWZP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9X3G9MMWZP');
</script>

           </head>
           <body>
            <header class="d-flex justify-content-center">
             <nav
                  class="navbar navbar-light bg-light w-100 mx-5 mb-3">
              <a class=navbar-brand href="/">Lisp HUG Maillist Archive</a>
             </nav>
            </header>
            <div class="d-flex justify-content-center">
             <div class="w-100 mx-5 px-3">
              <section class=tree>
               <article class=email>
                <h1>File "macros/specmac" and delivery on Linux</h1>
                <pre>
Hi,

I have a LispWorks server application that I deploy using an custom  
image called lw-base with only ASDF in it.
That image then loads some precompiled FASL files, as necessary, for  
each deploy of the application code.
That way, the server image and application can keep on running while  
being upgraded.

The deliver options are as follows:

(deliver #'(lambda ()
	     (lw-base:delivered-image-startup)
	     (start-tty-listener))
          "lw-base"
          0
          :multiprocessing t
          :keep-pretty-printer t
          :keep-debug-mode t
          :keep-conditions :all
          :interface nil)

This has been working very well for about two years on Mac OS X  
Client and Server over varioius LW versions.

I am now trying the same technique on Linux. At first everything  
seemed fine, but at runtime I get the error:

The file "macros/specmac" does not exist.

This is a load on demand file from the LispWorks library (/usr/lib/ 
LispWorks/lib/4-4-0-0/load-on-demand/pcl/macros/specmac.ufsl) that  
isn't present at runtime on the production server.
Previous lisp-hug messages show that this file is related to the  
compiler - my application is indeed using the compiler at runtime for  
lisp server pages.

The question now is: what module do I have to require before building  
my lw-base image, or what extra options do I need to give to deliver  
so that this load on demand code gets included up front ?

There is some urgency to this ;-)

Thx,

Sven


</pre>
               </article>
               <section class=tree>
                <article class=email>
                 <h1>Re: File "macros/specmac" and delivery on Linux</h1>
                 <p>
                  Unable to parse email body. Email id is 5359
                </article>
               </section>
              </section>
             </div>
            </div>
            <footer class="d-flex justify-content-center">
             <div>
              Updated at: 2020-12-07 08:45 UTC
             </div>
            </footer>
           </body>
          </html>