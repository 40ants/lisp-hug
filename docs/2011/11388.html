<!DOCTYPE html>
<html lang=en>
           <head>
            <meta charset=UTF-8>
            <title>FLI callbacks in LispWorks and best practices</title>
            <link rel=stylesheet
                  href=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css
                  integrity=sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2
                  crossorigin=anonymous>
            <style>
section.tree {
    padding-left: 2em;
}
section.tree:first-child {
    padding-left: 0;
}
.article-link {
  margin-bottom: 1em;
}
</style>
<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9X3G9MMWZP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9X3G9MMWZP');
</script>

           </head>
           <body>
            <header class="d-flex justify-content-center">
             <nav
                  class="navbar navbar-light bg-light w-100 mx-5 mb-3">
              <a class=navbar-brand href="/">Lisp HUG Maillist Archive</a>
             </nav>
            </header>
            <div class="d-flex justify-content-center">
             <div class="w-100 mx-5 px-3">
              <section class=tree>
               <article class=email>
                <h1>FLI callbacks in LispWorks and best practices</h1>
                <pre>
Hi to all and merry Thanksgiving,

I am writing a FLI wrapper around a library that uses C callbacks.

To avoid reinventing the wheel, I would like to learn about your experience regarding the lisp-side implementation within those callbacks.

More specifically here are two questions:

1.  The usual idiom for C callbacks is to provide a 'context' or 'userInfo' void pointer so the user of the library can specify the handle to an object at the time an asynchronous function is called.  Unfortunately, you can not pass a lisp object because the garbage collector could move this object between the time the function is called, and the callback is received.  What is your strategy?  Does LispWorks support 'pinned' objects?  Are they relevant?

2.  During the iterative development phase, the code I write obviously does not work the first time I evaluate it.  Code in the callback that yields a Lisp condition can be fatal for the lisp environment.  How can I safely handle the condition while still being able to run the debugger?  Do you have any suggestion?

Thank you in advance for any useful information you may have.


Best Regards,
Camille


</pre>
               </article>
               <section class=tree>
                <article class=email>
                 <h1>Re: FLI callbacks in LispWorks and best practices</h1>
                 <p>
                  Unable to parse email body. Email id is 11389
                </article>
               </section>
              </section>
             </div>
            </div>
            <footer class="d-flex justify-content-center">
             <div>
              Updated at: 2020-12-07 08:33 UTC
             </div>
            </footer>
           </body>
          </html>