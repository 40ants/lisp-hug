<!DOCTYPE html>
<html lang=en>
           <head>
            <meta charset=UTF-8>
            <title>Examples of using LWW COM to drive MS Excel or similar?</title>
            <meta name=viewport
                  content="width=device-width, initial-scale=1.0">
            <link rel=stylesheet
                  href=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css
                  integrity=sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2
                  crossorigin=anonymous>
            <style>
section.tree {
    padding-left: 2em;
}
section.tree:first-child {
    padding-left: 0;
}
.article-link {
  margin-bottom: 1em;
}
</style>
<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9X3G9MMWZP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9X3G9MMWZP');
</script>

           </head>
           <body>
            <header class="d-flex justify-content-center">
             <nav
                  class="navbar navbar-light bg-light w-100 mx-5 mb-3">
              <a class=navbar-brand href="/">Lisp HUG Maillist Archive</a>
             </nav>
            </header>
            <div class="d-flex justify-content-center">
             <div class="w-100 mx-5 px-3">
              <section class=tree>
               <article class=email>
                <h1>Examples of using LWW COM to drive MS Excel or similar?</h1>
                <pre>I'm about to look into getting data from a LWW session into Excel using 
the COM support in 4.2
Does anyone have any examples of doing this, or something similar, that 
they are prepared to share?  I looked at, but didn't use, the low-level 
COM stuff ages ago and have forgotten most of it. Looking at a working 
example would shorten my learning curve significantly.

-- 
Thanks
Guy.


</pre>
               </article>
               <section class=tree>
                <article class=email>
                 <h1>Re: Examples of using LWW COM to drive MS Excel or similar?</h1>
                 <pre>
: Examples of using LWW COM to drive MS Excel or similar?

Guy,

Is it important that you use COM? Excel 2002 (and only that version) imports
files formatted in XML Speadsheet Language. The specification is available
at:
http:// msdn.microsoft.com/ library/ en-us/ dnexcl2k2/ html/ odc_xmlss.asp

For example, let's say that you want to send something like
Contents of cell 1:    1
Contents of cell 2:    2
Contents of cell 3:    3
Contents of cell 4:    6  (computed as the sum of cells 1 to 3)


you should generate a file (with the .xml suffix):


&lt; header information skipped&gt


&lt;Worksheet ss:Name="Sheet1"&gt
- &lt;Table ss:ExpandedColumnCount="1" ss:ExpandedRowCount="4"
x:FullColumns="1" x:FullRows="1" ss:DefaultRowHeight="13.2"&gt
- &lt;Row&gt
- &lt;Cell&gt
  &lt;Data ss:Type="Number"&gt1&lt;/Data&gt
  &lt;/Cell&gt
  &lt;/Row&gt
- &lt;Row&gt
- &lt;Cell&gt
  &lt;Data ss:Type="Number"&gt2&lt;/Data&gt
  &lt;/Cell&gt
  &lt;/Row&gt
- &lt;Row&gt
- &lt;Cell&gt
  &lt;Data ss:Type="Number"&gt3&lt;/Data&gt
  &lt;/Cell&gt
  &lt;/Row&gt
- &lt;Row&gt
- &lt;Cell ss:Formula="=SUM(R[-3]C:R[-1]C)"&gt
  &lt;Data ss:Type="Number"&gt6&lt;/Data&gt
  &lt;/Cell&gt
  &lt;/Row&gt
  &lt;/Table&gt
- &lt;WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel"&gt


&lt;footer material goes here&gt

 I know that there are a number of ambiguities here and there
(Type="Number"), but it's one more option.


</pre>
                </article>
               </section>
               <section class=tree>
                <article class=email>
                 <h1>Re: Examples of using LWW COM to drive MS Excel or similar?</h1>
                 <pre>Guy Footring &lt;Guy@Footring.demon.co.uk&gt writes:

&gt I'm about to look into getting data from a LWW session into Excel
&gt using the COM support in 4.2
&gt Does anyone have any examples of doing this, or something similar,
&gt that they are prepared to share?  I looked at, but didn't use, the
&gt low-level COM stuff ages ago and have forgotten most of it. Looking
&gt at a working example would shorten my learning curve significantly.

I've recently written some code that uses Lispwork's DDE support to
connect to Excel and fill a spreadsheet. Very basic stuff but it does
what it's supposed to do. Let me know if you want it.

Cheers,
Edi.


</pre>
                </article>
               </section>
              </section>
             </div>
            </div>
            <footer class="d-flex justify-content-center">
             <div>
              Updated at: 2020-12-10 09:00 UTC
             </div>
            </footer>
           </body>
          </html>