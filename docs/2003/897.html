<!DOCTYPE html>
<html lang=en>
           <head>
            <meta charset=UTF-8>
            <title>COM. Questions and Bugs</title>
            <link rel=stylesheet
                  href=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css
                  integrity=sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2
                  crossorigin=anonymous>
            <style>
section.tree {
    padding-left: 2em;
}
section.tree:first-child {
    padding-left: 0;
}
.article-link {
  margin-bottom: 1em;
}
</style>
<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9X3G9MMWZP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9X3G9MMWZP');
</script>

           </head>
           <body>
            <header class="d-flex justify-content-center">
             <nav
                  class="navbar navbar-light bg-light w-100 mx-5 mb-3">
              <a class=navbar-brand href="/">Lisp HUG Maillist Archive</a>
             </nav>
            </header>
            <div class="d-flex justify-content-center">
             <div class="w-100 mx-5 px-3">
              <section class=tree>
               <article class=email>
                <h1>COM. Questions and Bugs</h1>
                <pre>
Hi

I am trying to delve deeper into COM (don't ask why).

W.r.t. what I was doing yesterday I think I fixed a few things.

First of all: in order to properly use COM:MIDL, you need to be sure to 
have the environments variables PATH and INCLUDE properly set up.

The example is "processed" by MIDL as expected.

However.

1 - MIDL does not seem to produce any resulting files.  Is this correct?
2 - The COM browsers available in the Tools menu seem to work only on
     "internal data structures".  Is that the case?  If so, the code
     snippets are there to be copied and pasted into regular editor
     windows?

Now on to more substantial questions, which may be stupid, but I figured 
I may ask here instead of wasting time figuring it out.

How do you produce a COM object that can be called from C/C++?  Do you 
deliver a .DLL or an .EXE?  Any suggestions?

Finally the big one.

&gt 
&gt CL-USER 4 &gt (com:midl "ACTIVSCP.IDL")
&gt ;;; Processing ACTIVSCP.IDL
&gt ;;; Processing C:\Program Files\Microsoft Visual Studio\VC98\Include\ocidl.idl
&gt ;;; Processing C:\Program Files\Microsoft Visual Studio\VC98\Include\oleidl.idl
&gt ;;; Processing C:\Program Files\Microsoft Visual Studio\VC98\Include\objidl.idl
&gt ;;; Processing C:\Program Files\Microsoft Visual Studio\VC98\Include\unknwn.idl
&gt ;;; Processing C:\Program Files\Microsoft Visual Studio\VC98\Include\wtypes.idl
&gt ;;; Processing C:\Program Files\Microsoft Visual Studio\VC98\Include\oaidl.idl
&gt ;;; Processing C:\Program Files\Microsoft Visual Studio\VC98\Include\servprov.idl
&gt ;;; Processing C:\Program Files\Microsoft Visual Studio\VC98\Include\urlmon.idl
&gt ;;; Processing C:\Program Files\Microsoft Visual Studio\VC98\Include\msxml.idl
&gt 
&gt Error: [C:\Program Files\Microsoft Visual Studio\VC98\Include\ocidl.idl:1036]: Unexpected symbol "FontEvents"
&gt Skipping rest of statement.;; Enum tagSCRIPTSTATE as TAG-SCRIPTSTATE
&gt ;;   Enum Constant SCRIPTSTATE_UNINITIALIZED as SCRIPTSTATE_UNINITIALIZED
&gt ;;   Enum Constant SCRIPTSTATE_INITIALIZED as SCRIPTSTATE_INITIALIZED
&gt ;;   Enum Constant SCRIPTSTATE_STARTED as SCRIPTSTATE_STARTED
&gt ;;   Enum Constant SCRIPTSTATE_CONNECTED as SCRIPTSTATE_CONNECTED
&gt ;;   Enum Constant SCRIPTSTATE_DISCONNECTED as SCRIPTSTATE_DISCONNECTED
&gt ;;   Enum Constant SCRIPTSTATE_CLOSED as SCRIPTSTATE_CLOSED
&gt ;; Typedef SCRIPTSTATE as SCRIPTSTATE
&gt ;; Enum tagSCRIPTTHREADSTATE as TAG-SCRIPTTHREADSTATE
&gt ;;   Enum Constant SCRIPTTHREADSTATE_NOTINSCRIPT as SCRIPTTHREADSTATE_NOTINSCRIPT
&gt ;;   Enum Constant SCRIPTTHREADSTATE_RUNNING as SCRIPTTHREADSTATE_RUNNING
&gt ;; Typedef SCRIPTTHREADSTATE as SCRIPTTHREADSTATE
&gt ;; Typedef SCRIPTTHREADID as SCRIPTTHREADID
&gt 
&gt 
&gt **++++ Error in (SUBFUNCTION |COM Member : (I-ACTIVE-SCRIPT-SITE GET-ITEM-INFO)| (SUBFUNCTION (FLI:DEFINE-FOREIGN-FUNCTION |COM Member : (I-ACTIVE-SCRIPT-SITE GET-ITEM-INFO)|) (COM:COM-INTERFACE I-ACTIVE-SCRIPT-SITE))): 
&gt   Illegal foreign type I-TYPE-INFO.
&gt ; *** 1 error detected, no fasl file produced.
&gt NIL
&gt (((SUBFUNCTION |COM Member : (I-ACTIVE-SCRIPT-SITE GET-ITEM-INFO)| (SUBFUNCTION (FLI:DEFINE-FOREIGN-FUNCTION |COM Member : (I-ACTIVE-SCRIPT-SITE GET-ITEM-INFO)|) (COM:COM-INTERFACE I-ACTIVE-SCRIPT-SITE))) #&lt;SIMPLE-ERROR 205FB02C&gt))
&gt T



I assume the above is a bug. (Actually more than one).
I really need this fixed.  Any idea about how to go ahead and do this?

Cheers

--
Marco Antoniotti




</pre>
               </article>
               <section class=tree>
                <article class=email>
                 <h1>Re: COM. Questions and Bugs</h1>
                 <p>
                  Unable to parse email body. Email id is 898
                </article>
                <section class=tree>
                 <article class=email>
                  <h1>Re: COM. Questions and Bugs</h1>
                  <pre>Thanks for the reply.

On Friday, Feb 28, 2003, at 13:17 America/New_York, Nick Levine wrote:

&gt
&gt    1 - MIDL does not seem to produce any resulting files.  Is this 
&gt correct?
&gt
&gt dunno
&gt
&gt    2 - The COM browsers available in the Tools menu seem to work only 
&gt on
&gt 	"internal data structures".  Is that the case?  If so, the code
&gt 	snippets are there to be copied and pasted into regular editor
&gt 	windows?
&gt
&gt The "COM Interface Browser" is fairly useful (although a navigation
&gt nightmare, plus a pain because you can't customize *package* in
&gt it)

Not good.  I need the package!


&gt . It tells you reliably what the interfaces you have on board. The
&gt code fragments are could be copied &amp; customized, though I rarely
&gt bother (particularly because I use automation in preference to COM
&gt whenever I can).

I have not clear at all the difference between COM and automation in MS 
stuff.  I am pretty sure that the people at MS do not have it clear 
either. :)

&gt
&gt    Now on to more substantial questions, which may be stupid, but I
&gt    figured I may ask here instead of wasting time figuring it out.
&gt
&gt    How do you produce a COM object that can be called from C/C++?  Do
&gt    you deliver a .DLL or an .EXE?  Any suggestions?
&gt
&gt The application I'm working with more or less forces me to have lisp
&gt as the dll. I pass a pointer to Dispatch (ie pDispatch on the C++
&gt side, :pointer on the lisp side).

Ok.  I'll have to look into that.  Thanks.

&gt
&gt    Finally the big one...
&gt
&gt Send as much as you can to lisp-support. Backtraces, IDL files, etc.


The backtrace is exactly what you saw.  ACTIVESCP.IDL is a standard 
ActiveX IDL in MSVC.  It is the active scripting IDL.

Cheers

--
Marco Antoniotti
NYU Courant Bioinformatics Group		tel. +1 - 212 - 998 3488
715 Broadway 10th FL				fax. +1 - 212 - 998 3484
New York, NY, 10003, U.S.A.


</pre>
                 </article>
                 <section class=tree>
                  <article class=email>
                   <h1>Re: COM. Questions and Bugs</h1>
                   <pre>&gt 
&gt I have not clear at all the difference between COM and automation in MS 
&gt stuff.  I am pretty sure that the people at MS do not have it clear 
&gt either. :)
&gt 

I think it is like this:

COM is anything that supports IUnknown.

COM automation is anything that supports IDispatch.

OLE is automation + connection points + aggregation.


</pre>
                  </article>
                  <section class=tree>
                   <article class=email>
                    <h1>Re: COM. Questions and Bugs</h1>
                    <pre>
On Friday, Feb 28, 2003, at 14:14 America/New_York, Joe Marshall wrote:

&gt&gt
&gt&gt I have not clear at all the difference between COM and automation in 
&gt&gt MS
&gt&gt stuff.  I am pretty sure that the people at MS do not have it clear
&gt&gt either. :)
&gt&gt
&gt
&gt I think it is like this:
&gt
&gt COM is anything that supports IUnknown.
&gt
&gt COM automation is anything that supports IDispatch.
&gt
&gt OLE is automation + connection points + aggregation.
&gt

Thanks.  I am not much into MS NewSpeak. :)

Cheers


--
Marco Antoniotti
NYU Courant Bioinformatics Group		tel. +1 - 212 - 998 3488
715 Broadway 10th FL				fax. +1 - 212 - 998 3484
New York, NY, 10003, U.S.A.


</pre>
                   </article>
                  </section>
                 </section>
                </section>
               </section>
               <section class=tree>
                <article class=email>
                 <h1>Re: COM. Questions and Bugs</h1>
                 <pre>I've been struggling with the COM functionality to get to the point 
where I can use it to drive Excel (I'm not sure if I'll ultimately use 
this route, but I'm at least trying to get it working), and have hit 
similar problems.  I think that the key part of the error message is:
&gt&gt(COM:COM-INTERFACE I-ACTIVE-SCRIPT-SITE))):    Illegal foreign type 
&gt&gtI-TYPE-INFO.
&gt&gt ; *** 1 error detected, no fasl file produced.

This keeps killing me too - some illegal foreign type which I have to 
spend inordinate amounts of time trying to track which type library it 
is defined in. In this case there appears to be a type library that 
includes ITypeInfo available from:
http://www.domaindlx.com/e_morcillo/scripts/type/default.asp

You can either define it to be part of a system using the 
:midl-type-library-file type (documented I believe) or use the 
undocumented COM:USE-TYPE-LIBRARY to load it.

I've also come across a definition for an IDL file for the ITypeInfo 
interface somewhere on the web - I'm sure Google will find it for you if 
you need it.

Hope this helps.

Regards
Guy.

In message &lt;3E5FA2CD.4020004@cs.nyu.edu&gt, Marco Antoniotti 
&lt;marcoxa@cs.nyu.edu&gt writes
&gt
&gtHi
&gt
&gtI am trying to delve deeper into COM (don't ask why).
&gt
&gtW.r.t. what I was doing yesterday I think I fixed a few things.
&gt
&gtFirst of all: in order to properly use COM:MIDL, you need to be sure to 
&gthave the environments variables PATH and INCLUDE properly set up.
&gt
&gtThe example is "processed" by MIDL as expected.
&gt
&gtHowever.
&gt
&gt1 - MIDL does not seem to produce any resulting files.  Is this correct?
&gt2 - The COM browsers available in the Tools menu seem to work only on
&gt    "internal data structures".  Is that the case?  If so, the code
&gt    snippets are there to be copied and pasted into regular editor
&gt    windows?
&gt
&gtNow on to more substantial questions, which may be stupid, but I 
&gtfigured I may ask here instead of wasting time figuring it out.
&gt
&gtHow do you produce a COM object that can be called from C/C++?  Do you 
&gtdeliver a .DLL or an .EXE?  Any suggestions?
&gt
&gtFinally the big one.
&gt
&gt&gt  CL-USER 4 &gt (com:midl "ACTIVSCP.IDL")
&gt&gt ;;; Processing ACTIVSCP.IDL
&gt&gt ;;; Processing C:\Program Files\Microsoft Visual 
&gt&gtStudio\VC98\Include\ocidl.idl
&gt&gt ;;; Processing C:\Program Files\Microsoft Visual 
&gt&gtStudio\VC98\Include\oleidl.idl
&gt&gt ;;; Processing C:\Program Files\Microsoft Visual 
&gt&gtStudio\VC98\Include\objidl.idl
&gt&gt ;;; Processing C:\Program Files\Microsoft Visual 
&gt&gtStudio\VC98\Include\unknwn.idl
&gt&gt ;;; Processing C:\Program Files\Microsoft Visual 
&gt&gtStudio\VC98\Include\wtypes.idl
&gt&gt ;;; Processing C:\Program Files\Microsoft Visual 
&gt&gtStudio\VC98\Include\oaidl.idl
&gt&gt ;;; Processing C:\Program Files\Microsoft Visual 
&gt&gtStudio\VC98\Include\servprov.idl
&gt&gt ;;; Processing C:\Program Files\Microsoft Visual 
&gt&gtStudio\VC98\Include\urlmon.idl
&gt&gt ;;; Processing C:\Program Files\Microsoft Visual 
&gt&gtStudio\VC98\Include\msxml.idl
&gt&gt  Error: [C:\Program Files\Microsoft Visual 
&gt&gtStudio\VC98\Include\ocidl.idl:1036]: Unexpected symbol "FontEvents"
&gt&gt Skipping rest of statement.;; Enum tagSCRIPTSTATE as TAG-SCRIPTSTATE
&gt&gt ;;   Enum Constant SCRIPTSTATE_UNINITIALIZED as SCRIPTSTATE_UNINITIALIZED
&gt&gt ;;   Enum Constant SCRIPTSTATE_INITIALIZED as SCRIPTSTATE_INITIALIZED
&gt&gt ;;   Enum Constant SCRIPTSTATE_STARTED as SCRIPTSTATE_STARTED
&gt&gt ;;   Enum Constant SCRIPTSTATE_CONNECTED as SCRIPTSTATE_CONNECTED
&gt&gt ;;   Enum Constant SCRIPTSTATE_DISCONNECTED as SCRIPTSTATE_DISCONNECTED
&gt&gt ;;   Enum Constant SCRIPTSTATE_CLOSED as SCRIPTSTATE_CLOSED
&gt&gt ;; Typedef SCRIPTSTATE as SCRIPTSTATE
&gt&gt ;; Enum tagSCRIPTTHREADSTATE as TAG-SCRIPTTHREADSTATE
&gt&gt ;;   Enum Constant SCRIPTTHREADSTATE_NOTINSCRIPT as 
&gt&gtSCRIPTTHREADSTATE_NOTINSCRIPT
&gt&gt ;;   Enum Constant SCRIPTTHREADSTATE_RUNNING as SCRIPTTHREADSTATE_RUNNING
&gt&gt ;; Typedef SCRIPTTHREADSTATE as SCRIPTTHREADSTATE
&gt&gt ;; Typedef SCRIPTTHREADID as SCRIPTTHREADID
&gt&gt   **++++ Error in (SUBFUNCTION |COM Member : (I-ACTIVE-SCRIPT-SITE 
&gt&gtGET-ITEM-INFO)| (SUBFUNCTION (FLI:DEFINE-FOREIGN-FUNCTION |COM Member 
&gt&gt: (I-ACTIVE-SCRIPT-SITE GET-ITEM-INFO)|) (COM:COM-INTERFACE 
&gt&gtI-ACTIVE-SCRIPT-SITE))):    Illegal foreign type I-TYPE-INFO.
&gt&gt ; *** 1 error detected, no fasl file produced.
&gt&gt NIL
&gt&gt (((SUBFUNCTION |COM Member : (I-ACTIVE-SCRIPT-SITE GET-ITEM-INFO)| 
&gt&gt(SUBFUNCTION (FLI:DEFINE-FOREIGN-FUNCTION |COM Member : 
&gt&gt(I-ACTIVE-SCRIPT-SITE GET-ITEM-INFO)|) (COM:COM-INTERFACE 
&gt&gtI-ACTIVE-SCRIPT-SITE))) #&lt;SIMPLE-ERROR 205FB02C&gt))
&gt&gt T
&gt
&gt
&gt
&gtI assume the above is a bug. (Actually more than one).
&gtI really need this fixed.  Any idea about how to go ahead and do this?
&gt
&gtCheers
&gt
&gt--
&gtMarco Antoniotti
&gt
&gt
&gt

-- 


</pre>
                </article>
                <section class=tree>
                 <article class=email>
                  <h1>Re: COM. Questions and Bugs</h1>
                  <pre>
On Friday, Feb 28, 2003, at 15:53 America/New_York, Guy Footring wrote:

&gt I've been struggling with the COM functionality to get to the point 
&gt where I can use it to drive Excel (I'm not sure if I'll ultimately use 
&gt this route, but I'm at least trying to get it working), and have hit 
&gt similar problems.  I think that the key part of the error message is:
&gt&gt&gt (COM:COM-INTERFACE I-ACTIVE-SCRIPT-SITE))):    Illegal foreign type 
&gt&gt&gt I-TYPE-INFO.
&gt&gt&gt ; *** 1 error detected, no fasl file produced.
&gt
&gt This keeps killing me too - some illegal foreign type which I have to 
&gt spend inordinate amounts of time trying to track which type library it 
&gt is defined in. In this case there appears to be a type library that 
&gt includes ITypeInfo available from:
&gt http://www.domaindlx.com/e_morcillo/scripts/type/default.asp

Sorry, but I do not understand the reference.  That is just a list of 
known interfaces.
The 'ITypeInfo' interface is defined in the standard file 'OAIDL.IDL' 
(which seems to be correctly processed by COM:MIDL.

&gt
&gt You can either define it to be part of a system using the 
&gt :midl-type-library-file type (documented I believe) or use the 
&gt undocumented COM:USE-TYPE-LIBRARY to load it.

I don't think this is going to work.  Eventually - AFAIU - you need to 
call COM:MIDL on a file containing the interface.  I can try to call 
COM:MIDL separately on 'OAIDL.IDL' to see whether I can load the 
'ITypeInfo' library beforehand.  Anyway, the 'FontEvents' error is 
still there.

&gt
&gt I've also come across a definition for an IDL file for the ITypeInfo 
&gt interface somewhere on the web - I'm sure Google will find it for you 
&gt if you need it.

You shouldn't be needing it.

&gt
&gt Hope this helps.
&gt

Well. It got me thinking.  Let's see how it works.

Cheers

Marco
--
Marco Antoniotti
NYU Courant Bioinformatics Group		tel. +1 - 212 - 998 3488
715 Broadway 10th FL				fax. +1 - 212 - 998 3484
New York, NY, 10003, U.S.A.


</pre>
                 </article>
                </section>
                <section class=tree>
                 <article class=email>
                  <h1>Re: COM. Questions and Bugs</h1>
                  <pre>In message &lt;3BDB39E6-4B68-11D7-9090-000393A70920@cs.nyu.edu&gt, Marco 
Antoniotti &lt;marcoxa@cs.nyu.edu&gt writes
&gt
&gtOn Friday, Feb 28, 2003, at 15:53 America/New_York, Guy Footring wrote:
&gt
&gt&gt I've been struggling with the COM functionality to get to the point 
&gt&gtwhere I can use it to drive Excel (I'm not sure if I'll ultimately use 
&gt&gtthis route, but I'm at least trying to get it working), and have hit 
&gt&gtsimilar problems.  I think that the key part of the error message is:
&gt&gt&gt&gt (COM:COM-INTERFACE I-ACTIVE-SCRIPT-SITE))):    Illegal foreign type 
&gt&gt&gt&gtI-TYPE-INFO.
&gt&gt&gt&gt ; *** 1 error detected, no fasl file produced.
&gt&gt
&gt&gt This keeps killing me too - some illegal foreign type which I have to 
&gt&gtspend inordinate amounts of time trying to track which type library it 
&gt&gtis defined in. In this case there appears to be a type library that 
&gt&gtincludes ITypeInfo available from:
&gt&gt http://www.domaindlx.com/e_morcillo/scripts/type/default.asp
&gt
&gtSorry, but I do not understand the reference.  That is just a list of 
&gtknown interfaces.

At the bottom was the option to download the OLELIB.TLB file that could 
(presumably) be loaded with COM:USE-TYPE-LIBRARY.

&gtThe 'ITypeInfo' interface is defined in the standard file 'OAIDL.IDL' 
&gt(which seems to be correctly processed by COM:MIDL.
&gt
&gt&gt
&gt&gt You can either define it to be part of a system using the
&gt&gt :midl-type-library-file type (documented I believe) or use the
&gt&gt undocumented COM:USE-TYPE-LIBRARY to load it.
&gt
&gtI don't think this is going to work.  Eventually - AFAIU - you need to 
&gtcall COM:MIDL on a file containing the interface.

I'm only using COM:USE-TYPE-LIBRARY for what I'm doing, so using MIDL 
isn't necessarily required.  If I understand correctly (which could 
quite easily not be the case) the type library file is some kind of 
compiled IDL file.

&gtI can try to call COM:MIDL separately on 'OAIDL.IDL' to see whether I 
&gtcan load the 'ITypeInfo' library beforehand.  Anyway, the 'FontEvents' 
&gterror is still there.
&gt

Looking in the ocidl.idl file the IFontsEventDisp interface doesn't 
follow the same pattern as the others in that the first statement isn't 
a typedef for IFontsEventDisp.  I've no idea whether this is a bug in 
ocidl.idl or simply something unusual that COM:MIDL is failing to deal 
with.  However, the FontsEvents error seems to have been recovered from, 
whereas the I-TYPE-INFO error was terminal.

&gt&gt
&gt&gt I've also come across a definition for an IDL file for the ITypeInfo 
&gt&gtinterface somewhere on the web - I'm sure Google will find it for you 
&gt&gtyou need it.
&gt
&gtYou shouldn't be needing it.
&gt
&gt&gt
&gt&gt Hope this helps.
&gt&gt
&gt
&gtWell. It got me thinking.  Let's see how it works.
&gt
&gtCheers
&gt
&gtMarco
&gt--
&gtMarco Antoniotti
&gtNYU Courant Bioinformatics Group               tel. +1 - 212 - 998 3488
&gt715 Broadway 10th FL                           fax. +1 - 212 - 998 3484
&gtNew York, NY, 10003, U.S.A.
&gt

-- 
Regards
Guy.


</pre>
                 </article>
                 <section class=tree>
                  <article class=email>
                   <h1>Re: COM. Questions and Bugs</h1>
                   <pre>
On Friday, Feb 28, 2003, at 17:32 America/New_York, Guy Footring wrote:

&gt In message &lt;3BDB39E6-4B68-11D7-9090-000393A70920@cs.nyu.edu&gt, Marco 
&gt Antoniotti &lt;marcoxa@cs.nyu.edu&gt writes
&gt&gt
&gt&gt On Friday, Feb 28, 2003, at 15:53 America/New_York, Guy Footring 
&gt&gt wrote:
&gt&gt
&gt&gt&gt I've been struggling with the COM functionality to get to the point 
&gt&gt&gt where I can use it to drive Excel (I'm not sure if I'll ultimately 
&gt&gt&gt use this route, but I'm at least trying to get it working), and have 
&gt&gt&gt hit similar problems.  I think that the key part of the error 
&gt&gt&gt message is:
&gt&gt&gt&gt&gt (COM:COM-INTERFACE I-ACTIVE-SCRIPT-SITE))):    Illegal foreign 
&gt&gt&gt&gt&gt type I-TYPE-INFO.
&gt&gt&gt&gt&gt ; *** 1 error detected, no fasl file produced.
&gt&gt&gt
&gt&gt&gt This keeps killing me too - some illegal foreign type which I have 
&gt&gt&gt to spend inordinate amounts of time trying to track which type 
&gt&gt&gt library it is defined in. In this case there appears to be a type 
&gt&gt&gt library that includes ITypeInfo available from:
&gt&gt&gt http://www.domaindlx.com/e_morcillo/scripts/type/default.asp
&gt&gt
&gt&gt Sorry, but I do not understand the reference.  That is just a list of 
&gt&gt known interfaces.
&gt
&gt At the bottom was the option to download the OLELIB.TLB file that 
&gt could (presumably) be loaded with COM:USE-TYPE-LIBRARY.


Ah.  Let me try it.

&gt
&gt&gt The 'ITypeInfo' interface is defined in the standard file 'OAIDL.IDL' 
&gt&gt (which seems to be correctly processed by COM:MIDL.
&gt&gt
&gt&gt&gt
&gt&gt&gt You can either define it to be part of a system using the
&gt&gt&gt :midl-type-library-file type (documented I believe) or use the
&gt&gt&gt undocumented COM:USE-TYPE-LIBRARY to load it.
&gt&gt
&gt&gt I don't think this is going to work.  Eventually - AFAIU - you need 
&gt&gt to call COM:MIDL on a file containing the interface.
&gt
&gt I'm only using COM:USE-TYPE-LIBRARY for what I'm doing, so using MIDL 
&gt isn't necessarily required.  If I understand correctly (which could 
&gt quite easily not be the case) the type library file is some kind of 
&gt compiled IDL file.
&gt
&gt&gt I can try to call COM:MIDL separately on 'OAIDL.IDL' to see whether I 
&gt&gt can load the 'ITypeInfo' library beforehand.  Anyway, the 
&gt&gt 'FontEvents' error is still there.
&gt&gt
&gt
&gt Looking in the ocidl.idl file the IFontsEventDisp interface doesn't 
&gt follow the same pattern as the others in that the first statement 
&gt isn't a typedef for IFontsEventDisp.  I've no idea whether this is a 
&gt bug in ocidl.idl or simply something unusual that COM:MIDL is failing 
&gt to deal with.  However, the FontsEvents error seems to have been 
&gt recovered from, whereas the I-TYPE-INFO error was terminal.

Ok.  You got further than I did on this one.

For the Lispworks people: it would be useful to know what exactly the 
MIDL file is doing.  I mean, at a high level, to understand its output.

Thanks

--
Marco Antoniotti
NYU Courant Bioinformatics Group		tel. +1 - 212 - 998 3488
715 Broadway 10th FL				fax. +1 - 212 - 998 3484
New York, NY, 10003, U.S.A.


</pre>
                  </article>
                  <section class=tree>
                   <article class=email>
                    <h1>Re: COM. Questions and Bugs</h1>
                    <pre>
On Friday, Feb 28, 2003, at 17:37 America/New_York, Marco Antoniotti 
wrote:

&gt
&gt On Friday, Feb 28, 2003, at 17:32 America/New_York, Guy Footring wrote:
&gt
&gt&gt In message &lt;3BDB39E6-4B68-11D7-9090-000393A70920@cs.nyu.edu&gt, Marco 
&gt&gt Antoniotti &lt;marcoxa@cs.nyu.edu&gt writes
&gt&gt&gt
&gt&gt&gt On Friday, Feb 28, 2003, at 15:53 America/New_York, Guy Footring 
&gt&gt&gt wrote:
&gt&gt&gt
&gt&gt&gt&gt I've been struggling with the COM functionality to get to the point 
&gt&gt&gt&gt where I can use it to drive Excel (I'm not sure if I'll ultimately 
&gt&gt&gt&gt use this route, but I'm at least trying to get it working), and 
&gt&gt&gt&gt have hit similar problems.  I think that the key part of the error 
&gt&gt&gt&gt message is:
&gt&gt&gt&gt&gt&gt (COM:COM-INTERFACE I-ACTIVE-SCRIPT-SITE))):    Illegal foreign 
&gt&gt&gt&gt&gt&gt type I-TYPE-INFO.
&gt&gt&gt&gt&gt&gt ; *** 1 error detected, no fasl file produced.
&gt&gt&gt&gt
&gt&gt&gt&gt This keeps killing me too - some illegal foreign type which I have 
&gt&gt&gt&gt to spend inordinate amounts of time trying to track which type 
&gt&gt&gt&gt library it is defined in. In this case there appears to be a type 
&gt&gt&gt&gt library that includes ITypeInfo available from:
&gt&gt&gt&gt http://www.domaindlx.com/e_morcillo/scripts/type/default.asp
&gt&gt&gt
&gt&gt&gt Sorry, but I do not understand the reference.  That is just a list 
&gt&gt&gt of known interfaces.
&gt&gt
&gt&gt At the bottom was the option to download the OLELIB.TLB file that 
&gt&gt could (presumably) be loaded with COM:USE-TYPE-LIBRARY.
&gt

COM:USE-TYPE-LIBRARY is unbound and undefined in 4.2.7.

Now what?

--
Marco Antoniotti
NYU Courant Bioinformatics Group		tel. +1 - 212 - 998 3488
715 Broadway 10th FL				fax. +1 - 212 - 998 3484
New York, NY, 10003, U.S.A.


</pre>
                   </article>
                   <section class=tree>
                    <article class=email>
                     <h1>Re: COM. Questions and Bugs</h1>
                     <p>
                      Unable to parse email body. Email id is 907
                    </article>
                   </section>
                  </section>
                  <section class=tree>
                   <article class=email>
                    <h1>Re: COM. Questions and Bugs</h1>
                    <pre>In message &lt;EC832116-4B6E-11D7-9090-000393A70920@cs.nyu.edu&gt, Marco 
Antoniotti &lt;marcoxa@cs.nyu.edu&gt writes
&gt
&gtOn Friday, Feb 28, 2003, at 17:37 America/New_York, Marco Antoniotti 
&gtwrote:
&gt
&gt&gt
&gt&gt On Friday, Feb 28, 2003, at 17:32 America/New_York, Guy Footring wrote:
&gt&gt
&gt&gt&gt In message &lt;3BDB39E6-4B68-11D7-9090-000393A70920@cs.nyu.edu&gt, Marco 
&gt&gt&gtAntoniotti &lt;marcoxa@cs.nyu.edu&gt writes
&gt&gt&gt&gt
&gt&gt&gt&gt On Friday, Feb 28, 2003, at 15:53 America/New_York, Guy Footring 
&gt&gt&gt&gtwrote:
&gt&gt&gt&gt
&gt&gt&gt&gt&gt I've been struggling with the COM functionality to get to the 
&gt&gt&gt&gt&gtpoint where I can use it to drive Excel (I'm not sure if I'll 
&gt&gt&gt&gt&gtultimately  use this route, but I'm at least trying to get it 
&gt&gt&gt&gt&gtworking), and  have hit similar problems.  I think that the key 
&gt&gt&gt&gt&gtpart of the error  message is:
&gt&gt&gt&gt&gt&gt&gt (COM:COM-INTERFACE I-ACTIVE-SCRIPT-SITE))):    Illegal foreign 
&gt&gt&gt&gt&gt&gt&gttype I-TYPE-INFO.
&gt&gt&gt&gt&gt&gt&gt ; *** 1 error detected, no fasl file produced.
&gt&gt&gt&gt&gt
&gt&gt&gt&gt&gt This keeps killing me too - some illegal foreign type which I have 
&gt&gt&gt&gt&gtto spend inordinate amounts of time trying to track which type 
&gt&gt&gt&gt&gtlibrary it is defined in. In this case there appears to be a type 
&gt&gt&gt&gt&gtlibrary that includes ITypeInfo available from:
&gt&gt&gt&gt&gt http://www.domaindlx.com/e_morcillo/scripts/type/default.asp
&gt&gt&gt&gt
&gt&gt&gt&gt Sorry, but I do not understand the reference.  That is just a list 
&gt&gt&gt&gtknown interfaces.
&gt&gt&gt
&gt&gt&gt At the bottom was the option to download the OLELIB.TLB file that 
&gt&gt&gtcould (presumably) be loaded with COM:USE-TYPE-LIBRARY.
&gt&gt
&gt
&gtCOM:USE-TYPE-LIBRARY is unbound and undefined in 4.2.7.
&gt

It works for me in 4.2.7
I'm REQUIREing "com" and "automation".  Are you only REQUIREing "com"? 
Perhaps it is defined there.

Guy.

&gtNow what?
&gt
&gt--
&gtMarco Antoniotti
&gtNYU Courant Bioinformatics Group               tel. +1 - 212 - 998 3488
&gt715 Broadway 10th FL                           fax. +1 - 212 - 998 3484
&gtNew York, NY, 10003, U.S.A.
&gt

-- 


</pre>
                   </article>
                   <section class=tree>
                    <article class=email>
                     <h1>Re: COM. Questions and Bugs</h1>
                     <pre>
On Saturday, Mar 1, 2003, at 02:31 America/New_York, Guy Footring wrote:
&gt
&gt It works for me in 4.2.7
&gt I'm REQUIREing "com" and "automation".  Are you only REQUIREing "com"? 
&gt Perhaps it is defined there.
&gt

Thanks for the hint.  I was very stupid.

REQUIRing "automation" makes the

	(com:midl "ACTIVSCP.IDL")

call work. (Except for the FontEvents) problem.

I will keep you posted about my progress.

Cheers

--
Marco Antoniotti
NYU Courant Bioinformatics Group		tel. +1 - 212 - 998 3488
715 Broadway 10th FL				fax. +1 - 212 - 998 3484
New York, NY, 10003, U.S.A.


</pre>
                    </article>
                   </section>
                  </section>
                 </section>
                </section>
               </section>
              </section>
             </div>
            </div>
            <footer class="d-flex justify-content-center">
             <div>
              Updated at: 2020-12-07 08:56 UTC
             </div>
            </footer>
           </body>
          </html>