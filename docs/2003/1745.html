<!DOCTYPE html>
<html lang=en>
           <head>
            <meta charset=UTF-8>
            <title>Questions about capi list panels.</title>
            <link rel=stylesheet
                  href=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css
                  integrity=sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2
                  crossorigin=anonymous>
            <style>
section.tree {
    padding-left: 2em;
}
section.tree:first-child {
    padding-left: 0;
}
.article-link {
  margin-bottom: 1em;
}
</style>
<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9X3G9MMWZP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9X3G9MMWZP');
</script>

           </head>
           <body>
            <header class="d-flex justify-content-center">
             <nav
                  class="navbar navbar-light bg-light w-100 mx-5 mb-3">
              <a class=navbar-brand href="/">Lisp HUG Maillist Archive</a>
             </nav>
            </header>
            <div class="d-flex justify-content-center">
             <div class="w-100 mx-5 px-3">
              <section class=tree>
               <article class=email>
                <h1>Questions about capi list panels.</h1>
                <pre>I have some questions about the following code. 
Please cut and paste it in the LWW listener to clarify
the questions.

(capi:contain
 (make-instance 'capi:list-panel
   :items '("a1" "a2" "a3")
   :action-callback
   (lambda (&amp;rest args)
     (capi:contain
      (make-instance 'capi:list-panel
        :items '("b1" "b2" "b3"))))))

The following assumes you are running the above
example code, and the first window is displayed.

First, hold down the "a" key, with autorepeat causing
it to send a sequence of "a" characters.  Notice the
behavior.  It's normal behavior for a list panel.  At
this point, stop and press the return key, which
brings up the 2nd window.  Pause for a second or more,
then do the same autorepeat, but with the "b" key. 
Again, normal behavior for a list panel.

Now close the 2nd window and this time do it faster,
with no significant pause before the first "b".

Notice the difference?  Can anyone explain it?

If you don't notice any difference, let me clarify the
action a little:  There are two ways to do it, and
each shows different behavior.  Both ways, you invoke
the 2nd window with the return key, within a fraction
of a second after the last "a".  But, the first way,
you pause after that, for a second or more.  The 2nd
way, you proceed immediately, such that your first
keystroke in the 2nd window happens within a fraction
of a second after the 2nd window is visible.

All I want is to understand exactly what is causing
the difference in behavior, and what I can do to
prevent that difference.

If someone has a solution, could you please send me a
modified version of the above code, such that the
behavior becomes the same regardless of the pause?

I suspect it might have something to do with the way a
list-panel accumulates keystrokes.  A pause tells it
you want to discard your previous keystrokes and start
a new search.  But in this case, the 2nd list panel
was created immediately before the first keystroke in
it, so a pause before that keystroke should have no
effect, as it should start a new search regardless. 
Or are the two list panels somehow interfering with
each other?


__________________________________
Do you Yahoo!?
Free Pop-Up Blocker - Get it now
http://companion.yahoo.com/


</pre>
               </article>
               <section class=tree>
                <article class=email>
                 <h1>Re: Questions about capi list panels.</h1>
                 <p>
                  Unable to parse email body. Email id is 1750
                </article>
                <section class=tree>
                 <article class=email>
                  <h1>Re: Questions about capi list panels.</h1>
                  <pre>--- davef@xanalys.com wrote:
&gt The problem is that this timer is global and takes
&gt no account of the
&gt possibility that multiple list panels exist. We'll
&gt look into fixing
&gt this.

Meanwhile, can I just force the timer to jump to the
end of its timeout period?  If I did that in the
callback triggered by selecting the highlighted item,
the problem would be solved, wouldn't it?  How do I
access the timer?

I have another question about the search logic.  If
one of my items starts with "Ah" (but not "Aha") and
the next item starts with "Ai", and I type "aha" at
full speed, it goes to the "Ai" item.  That implies
that the timeout is bypassed in that case.  But it's
not clear exactly how it decides when to do that
bypass.  If I type "ahb" at full speed, it gets stuck
on the "Ah" item, and doesn't go to my "B" items.  How
does the 2nd "a" cause the timer to be bypassed when
the "b" doesn't?


__________________________________
Do you Yahoo!?
Free Pop-Up Blocker - Get it now
http://companion.yahoo.com/


</pre>
                 </article>
                 <section class=tree>
                  <article class=email>
                   <h1>Re: Questions about capi list panels.</h1>
                   <p>
                    Unable to parse email body. Email id is 1752
                  </article>
                 </section>
                </section>
               </section>
              </section>
             </div>
            </div>
            <footer class="d-flex justify-content-center">
             <div>
              Updated at: 2020-12-07 08:54 UTC
             </div>
            </footer>
           </body>
          </html>