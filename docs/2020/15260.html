<!DOCTYPE html>
<html lang=en>
           <head>
            <meta charset=UTF-8>
            <title>High performance lib</title>
            <link rel=stylesheet
                  href=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css
                  integrity=sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2
                  crossorigin=anonymous>
            <style>
section.tree {
    padding-left: 2em;
}
section.tree:first-child {
    padding-left: 0;
}
.article-link {
  margin-bottom: 1em;
}
</style>
           </head>
           <body>
            <div class="d-flex justify-content-center">
             <nav
                  class="navbar navbar-light bg-light w-100 mx-5 mb-3">
              <a class=navbar-brand href="/">Lisp HUG Maillist Archive</a>
             </nav>
            </div>
            <div class="d-flex justify-content-center">
             <div class="w-100 mx-5 px-3">
              <section class=tree>
               <article class=email>
                <h1>High performance lib</h1><html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" xmlns="http://www.w3.org/TR/REC-html40">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<meta name="Generator" content="Microsoft Word 15 (filtered medium)">
<style><!--
/* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri",sans-serif;
	color:windowtext;}
..MsoChpDefault
	{mso-style-type:export-only;
	font-family:"Calibri",sans-serif;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
--></style><!--[if gte mso 9]><xml>
<o:shapedefaults v:ext="edit" spidmax="1026" />
</xml><![endif]--><!--[if gte mso 9]><xml>
<o:shapelayout v:ext="edit">
<o:idmap v:ext="edit" data="1" />
</o:shapelayout></xml><![endif]-->
</head>
<body lang="EN-US" link="#0563C1" vlink="#954F72">
<div class="WordSection1">
<p class="MsoNormal"><span style="font-size:14.0pt">Hello All,<o:p></o:p></span></p>
<p class="MsoNormal"><span style="font-size:14.0pt"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span style="font-size:14.0pt">I need to write a block file store library for work. It has to be fast, because I need to saturate a 10Gbe link. &nbsp;It is basically just storing file blocks in an sqlite3 database with sha256 hashes. I also
 need to create a server application to serve files from the block store. I started to write this in C, but there isn&#8217;t really any heavy cpu related stuff other than sha256 and LZ4 compression (which I assume is probably cffi anyway). I&#8217;m thinking about using
 Lisp for this project, because the requirements aren&#8217;t completely nailed down and Lisp is so great in situations like this. I have never really tried to write anything that is performance critical in Lisp. This is a rare situation where I can use any language
 I wish. Would someone please give me some advice on whether it would be possible to get the performance I need?<o:p></o:p></span></p>
<p class="MsoNormal"><span style="font-size:14.0pt"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span style="font-size:14.0pt">I was considering actor based concurrency for the file server. Does anyone know if someone has written a scheduler which maps green threads to native threads (like erlang)? I&#8217;ve done some looking around, but
 I haven&#8217;t found anything yet. <o:p></o:p></span></p>
<p class="MsoNormal"><span style="font-size:14.0pt"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span style="font-size:14.0pt">Thanks,<o:p></o:p></span></p>
<p class="MsoNormal"><span style="font-size:14.0pt">-G<o:p></o:p></span></p>
<p class="MsoNormal"><span style="font-size:14.0pt"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
</div>
</body>
</html>


               </article>
               <section class=tree>
                <article class=email>
                 <h1>RE: High performance lib</h1><html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" xmlns="http://www.w3.org/TR/REC-html40">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="Generator" content="Microsoft Word 15 (filtered medium)">
<style><!--
/* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
.MsoChpDefault
	{mso-style-type:export-only;
	font-size:10.0pt;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
--></style><!--[if gte mso 9]><xml>
<o:shapedefaults v:ext="edit" spidmax="1026" />
</xml><![endif]--><!--[if gte mso 9]><xml>
<o:shapelayout v:ext="edit">
<o:idmap v:ext="edit" data="1" />
</o:shapelayout></xml><![endif]-->
</head>
<body lang="EN-US" link="blue" vlink="purple">
<div class="WordSection1">
<p class="MsoNormal"><span style="font-size:14.0pt">Hi Jerome,<o:p></o:p></span></p>
<p class="MsoNormal"><span style="font-size:14.0pt"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span style="font-size:14.0pt">I am aware of bordeaux-threads, but I never looked at it in depth. I will definitely take a look. I appreciate the pointer.<o:p></o:p></span></p>
<p class="MsoNormal"><span style="font-size:14.0pt"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span style="font-size:14.0pt">Thanks,<o:p></o:p></span></p>
<p class="MsoNormal"><span style="font-size:14.0pt">-G<o:p></o:p></span></p>
<p class="MsoNormal"><span style="font-size:14.0pt"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span style="font-size:14.0pt"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span style="font-size:14.0pt"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal"><span style="font-size:14.0pt"><o:p>&nbsp;</o:p></span></p>
<div>
<div style="border:none;border-top:solid #E1E1E1 1.0pt;padding:3.0pt 0in 0in 0in">
<p class="MsoNormal"><b>From:</b> Jerome Chan &lt;eviltofu@mac.com&gt; <br>
<b>Sent:</b> Saturday, May 23, 2020 10:00 PM<br>
<b>To:</b> Gerry Weaver &lt;gerryw@compvia.com&gt;<br>
<b>Subject:</b> Re: High performance lib<o:p></o:p></p>
</div>
</div>
<p class="MsoNormal"><o:p>&nbsp;</o:p></p>
<div>
<p class="MsoNormal">Have you taken a look at&nbsp;<a href="https://github.com/sionescu/bordeaux-threads">https://github.com/sionescu/bordeaux-threads</a>&nbsp;? There is a LispWorks implementation. I’ve not been able to play with this in LispWorks as the personal edition
 does not allow me to load it via quicklisp.<o:p></o:p></p>
<div>
<p class="MsoNormal"><br>
<br>
<o:p></o:p></p>
<blockquote style="margin-top:5.0pt;margin-bottom:5.0pt">
<p class="MsoNormal" style="margin-bottom:12.0pt">On 24 May 2020, at 10:23, Gerry Weaver &lt;<a href="mailto:gerryw@compvia.com">gerryw@compvia.com</a>&gt; wrote:<o:p></o:p></p>
</blockquote>
</div>
<blockquote style="margin-top:5.0pt;margin-bottom:5.0pt">
<div>
<p class="MsoNormal">﻿ <o:p></o:p></p>
<p class="MsoNormal"><span style="font-size:14.0pt">Hello All,</span><o:p></o:p></p>
<p class="MsoNormal"><span style="font-size:14.0pt">&nbsp;</span><o:p></o:p></p>
<p class="MsoNormal"><span style="font-size:14.0pt">I need to write a block file store library for work. It has to be fast, because I need to saturate a 10Gbe link. &nbsp;It is basically just storing file blocks in an sqlite3 database with sha256 hashes. I also
 need to create a server application to serve files from the block store. I started to write this in C, but there isn’t really any heavy cpu related stuff other than sha256 and LZ4 compression (which I assume is probably cffi anyway). I’m thinking about using
 Lisp for this project, because the requirements aren’t completely nailed down and Lisp is so great in situations like this. I have never really tried to write anything that is performance critical in Lisp. This is a rare situation where I can use any language
 I wish. Would someone please give me some advice on whether it would be possible to get the performance I need?</span><o:p></o:p></p>
<p class="MsoNormal"><span style="font-size:14.0pt">&nbsp;</span><o:p></o:p></p>
<p class="MsoNormal"><span style="font-size:14.0pt">I was considering actor based concurrency for the file server. Does anyone know if someone has written a scheduler which maps green threads to native threads (like erlang)? I’ve done some looking around, but
 I haven’t found anything yet. </span><o:p></o:p></p>
<p class="MsoNormal"><span style="font-size:14.0pt">&nbsp;</span><o:p></o:p></p>
<p class="MsoNormal"><span style="font-size:14.0pt">Thanks,</span><o:p></o:p></p>
<p class="MsoNormal"><span style="font-size:14.0pt">-G</span><o:p></o:p></p>
<p class="MsoNormal"><span style="font-size:14.0pt">&nbsp;</span><o:p></o:p></p>
<p class="MsoNormal">&nbsp;<o:p></o:p></p>
</div>
</blockquote>
</div>
</div>
</body>
</html>

                </article>
               </section>
               <section class=tree>
                <article class=email>
                 <h1>Re: High performance lib</h1><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; line-break: after-white-space;" class="">Hi Gerry,<div class=""><br class=""></div><div class="">I have done a ton of high performance code from Lisp - mostly for signal and image processing. But while working on the open source Emotiq / Stegos effort we used the Actors system - which I happen to think is a terrific way to go.</div><div class=""><br class=""></div><div class="">For file I/O I have used memory mapped file I/O for very high persistent store performance. And LZ4 doesn’t need to call FFI - it can be done quite easily from high level Lisp. For Sha256 there is the Ironclad library in high level Lisp. Going to C might buy you a bit of speed, but I doubt that will be the bottleneck in your code.</div><div class=""><br class=""></div><div class="">Instead, I think your biggest challenge will be the network connection at 10 Gb. Networking in Lisp is still a bit of a mash up…</div><div class=""><br class=""></div><div class="">- DM<br class=""><div><br class=""><blockquote type="cite" class=""><div class="">On May 23, 2020, at 7:21 PM, Gerry Weaver &lt;<a href="mailto:gerryw@compvia.com" class="">gerryw@compvia.com</a>&gt; wrote:</div><br class="Apple-interchange-newline"><div class=""><div class="WordSection1" style="page: WordSection1; caret-color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration: none;"><div style="margin: 0in 0in 0.0001pt; font-size: 11pt; font-family: Calibri, sans-serif;" class=""><span style="font-size: 14pt;" class="">Hello All,<o:p class=""></o:p></span></div><div style="margin: 0in 0in 0.0001pt; font-size: 11pt; font-family: Calibri, sans-serif;" class=""><span style="font-size: 14pt;" class=""><o:p class="">&nbsp;</o:p></span></div><div style="margin: 0in 0in 0.0001pt; font-size: 11pt; font-family: Calibri, sans-serif;" class=""><span style="font-size: 14pt;" class="">I need to write a block file store library for work. It has to be fast, because I need to saturate a 10Gbe link. &nbsp;It is basically just storing file blocks in an sqlite3 database with sha256 hashes. I also need to create a server application to serve files from the block store. I started to write this in C, but there isn’t really any heavy cpu related stuff other than sha256 and LZ4 compression (which I assume is probably cffi anyway). I’m thinking about using Lisp for this project, because the requirements aren’t completely nailed down and Lisp is so great in situations like this. I have never really tried to write anything that is performance critical in Lisp. This is a rare situation where I can use any language I wish. Would someone please give me some advice on whether it would be possible to get the performance I need?<o:p class=""></o:p></span></div><div style="margin: 0in 0in 0.0001pt; font-size: 11pt; font-family: Calibri, sans-serif;" class=""><span style="font-size: 14pt;" class=""><o:p class="">&nbsp;</o:p></span></div><div style="margin: 0in 0in 0.0001pt; font-size: 11pt; font-family: Calibri, sans-serif;" class=""><span style="font-size: 14pt;" class="">I was considering actor based concurrency for the file server. Does anyone know if someone has written a scheduler which maps green threads to native threads (like erlang)? I’ve done some looking around, but I haven’t found anything yet.<span class="Apple-converted-space">&nbsp;</span><o:p class=""></o:p></span></div><div style="margin: 0in 0in 0.0001pt; font-size: 11pt; font-family: Calibri, sans-serif;" class=""><span style="font-size: 14pt;" class=""><o:p class="">&nbsp;</o:p></span></div><div style="margin: 0in 0in 0.0001pt; font-size: 11pt; font-family: Calibri, sans-serif;" class=""><span style="font-size: 14pt;" class="">Thanks,<o:p class=""></o:p></span></div><div style="margin: 0in 0in 0.0001pt; font-size: 11pt; font-family: Calibri, sans-serif;" class=""><span style="font-size: 14pt;" class="">-G</span></div></div></div></blockquote></div><br class=""></div></body></html>

                </article>
               </section>
               <section class=tree>
                <article class=email>
                 <h1>Re: High performance lib</h1><div dir="ltr"><div dir="ltr">Hi Gerry<br><br>Start with simple experiments, then characterize them.<br><br>Answer these questions:<br><br>- What is your biggest unknown?<br><br>- What is the cheapest experiment you can do to better understand that unknown?<br><br>- How can you characterize that experiment and its results?<br><br>Then, repeat.<br><br><br>For example, I think your biggest unkown is speed.<br><br>Speed of what?<br><br>Simple experiment - how fast can you pull characters out of SQLite?<br><br>Simple experiment - how fast can you push characters down the throat of the link?<br><br>Simple experiment(s) - increase the buffer size from single characters to ??? (1K, 100K, 1M, 1G)<br><br>Simple experiment - which operating systems / languages / products let you get at SMP?<br><br>Simple question - will you need MMAP?  What will make this less painful?<br><br>Simple characterization (for speed-related unknowns) : profiling.<br><br>Simple question - build vs. buy.  What can you buy in (from, say, github) that will help you?  What do you need to control (i.e. build yourself, instead of githubbing)?<br><br><br>My gut says that using C instead of Lisp won&#39;t buy you nearly as much as getting rid of the operating system (and SQLite?).<br><br><br>When I needed bare-metal speeds, I wrote device drivers.  I used Harel Statecharts to avoid spaghetti code.[1]<br><br>Simple question - can you find any ethernet stacks written on top of any operating system?  Are such stacks written only at the device driver level?  How does your problem compare to ethernet speeds?<br><br><br>Green threads are closure wannabes.  (Greenspun&#39;s 10th Rule).<br><br>Red threads are green-thread wannabes, with the added complication of Time-Sharing (full preemption).  Time-sharing is the reason that multi-tasking has a bad name.  AFAIK, Erlang is based on the Time-sharing paradigm (using call-counting, instead of timer interrupts).<br><br>Simple question - can you get away with using Bordeaux Threads?  It&#39;s just an abstraction, a union of what is available in various implementations.  Create an experiment.  Can you get away with using any Actors libraries?<br><br><br>Other places to look: Doug Hoyte&#39;s &quot;Anti-Web&quot;.  A web server that doesn&#39;t use O/S threads, AFAIK.<br><br>pt<br><br>[1] Threads/Processes are state machines.  State is scurried away on the stacks.  Separate stacks for processes are overheads.  O/S&#39;es hide these overheads from you.  Separate stacks are OO.  OO is a skin on closures.  OO targets data only, and screws up control-flow.  The worst problem in Software is Design Intent and Structure (aka &quot;Architecture&quot;).  Speed problems have tools (profilers).  Spaghetti Architectures do not have tools, AFAIK.  HLLs are the best that we have.  And self-discipline.<br></div><div class="gmail_quote"><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"><div lang="EN-US"><div class="gmail-m_-7212283712617684875WordSection1">
</div>
</div>

</blockquote></div></div>


                </article>
                <section class=tree>
                 <article class=email>
                  <h1>Re: High performance lib</h1><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"></head><body dir="auto">Hi Paul,&nbsp;<div>great answer, I personally havent tried this, but read that a lot of overhead is at OS/user process boundary especially in networking (copying data between kernel space and use space) and there is a possibility to use “unikernel” solution.. But I wonder if anyone here has experience running lispworks application as unikernel. &nbsp;<div><br></div><div>The networking guys were telling me that the difference between unikernel and standard solution (few years back) was quite dramatic in their use case. Like going from 20MB a second 400MB a second, just by dropping the kernel userspace barrier &nbsp;copy problem in unikernel solution.<br><br><div dir="ltr">Ladislav Koščo&nbsp;<div>+421-949-49-36-36</div></div><div dir="ltr"><br><blockquote type="cite">On 24 May 2020, at 12:19, paul tarvydas &lt;paultarvydas@gmail.com&gt; wrote:<br><br></blockquote></div><blockquote type="cite"><div dir="ltr">﻿<div dir="ltr"><div dir="ltr">Hi Gerry<br><br>Start with simple experiments, then characterize them.<br><br>Answer these questions:<br><br>- What is your biggest unknown?<br><br>- What is the cheapest experiment you can do to better understand that unknown?<br><br>- How can you characterize that experiment and its results?<br><br>Then, repeat.<br><br><br>For example, I think your biggest unkown is speed.<br><br>Speed of what?<br><br>Simple experiment - how fast can you pull characters out of SQLite?<br><br>Simple experiment - how fast can you push characters down the throat of the link?<br><br>Simple experiment(s) - increase the buffer size from single characters to ??? (1K, 100K, 1M, 1G)<br><br>Simple experiment - which operating systems / languages / products let you get at SMP?<br><br>Simple question - will you need MMAP?&nbsp; What will make this less painful?<br><br>Simple characterization (for speed-related unknowns) : profiling.<br><br>Simple question - build vs. buy.&nbsp; What can you buy in (from, say, github) that will help you?&nbsp; What do you need to control (i.e. build yourself, instead of githubbing)?<br><br><br>My gut says that using C instead of Lisp won't buy you nearly as much as getting rid of the operating system (and SQLite?).<br><br><br>When I needed bare-metal speeds, I wrote device drivers.&nbsp; I used Harel Statecharts to avoid spaghetti code.[1]<br><br>Simple question - can you find any ethernet stacks written on top of any operating system?&nbsp; Are such stacks written only at the device driver level?&nbsp; How does your problem compare to ethernet speeds?<br><br><br>Green threads are closure wannabes. &nbsp;(Greenspun's 10th Rule).<br><br>Red threads are green-thread wannabes, with the added complication of Time-Sharing (full preemption).&nbsp; Time-sharing is the reason that multi-tasking has a bad name.&nbsp; AFAIK, Erlang is based on the Time-sharing paradigm (using call-counting, instead of timer interrupts).<br><br>Simple question - can you get away with using Bordeaux Threads?&nbsp; It's just an abstraction, a union of what is available in various implementations.&nbsp; Create an experiment.&nbsp; Can you get away with using any Actors libraries?<br><br><br>Other places to look: Doug Hoyte's "Anti-Web".&nbsp; A web server that doesn't use O/S threads, AFAIK.<br><br>pt<br><br>[1] Threads/Processes are state machines.&nbsp; State is scurried away on the stacks.&nbsp; Separate stacks for processes are overheads.&nbsp; O/S'es hide these overheads from you.&nbsp; Separate stacks are OO.&nbsp; OO is a skin on closures.&nbsp; OO targets data only, and screws up control-flow.&nbsp; The worst problem in Software is Design Intent and Structure (aka "Architecture").&nbsp; Speed problems have tools (profilers).&nbsp; Spaghetti Architectures do not have tools, AFAIK.&nbsp; HLLs are the best that we have.&nbsp; And self-discipline.<br></div><div class="gmail_quote"><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"><div lang="EN-US"><div class="gmail-m_-7212283712617684875WordSection1">
</div>
</div>

</blockquote></div></div>
</div></blockquote></div></div></body></html>

                 </article>
                </section>
                <section class=tree>
                 <article class=email>
                  <h1>Re: High performance lib</h1><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; line-break: after-white-space;" class="">… yep, that sounds right. One of my old Profs developed something called the X Kernel (not X Windows) that explicitly avoided buffer copying for high performance networking.<div class=""><br class=""></div><div class="">- DM<br class=""><div><br class=""><blockquote type="cite" class=""><div class="">On May 24, 2020, at 10:49 PM, <a href="mailto:laci.kosco@gmail.com" class="">laci.kosco@gmail.com</a> wrote:</div><br class="Apple-interchange-newline"><div class=""><meta http-equiv="content-type" content="text/html; charset=utf-8" class=""><div dir="auto" class="">Hi Paul,&nbsp;<div class="">great answer, I personally havent tried this, but read that a lot of overhead is at OS/user process boundary especially in networking (copying data between kernel space and use space) and there is a possibility to use “unikernel” solution. But I wonder if anyone here has experience running lispworks application as unikernel. &nbsp;<div class=""><br class=""></div><div class="">The networking guys were telling me that the difference between unikernel and standard solution (few years back) was quite dramatic in their use case. Like going from 20MB a second 400MB a second, just by dropping the kernel userspace barrier &nbsp;copy problem in unikernel solution.<br class=""><br class=""><div dir="ltr" class="">Ladislav Koščo&nbsp;<div class="">+421-949-49-36-36</div></div><div dir="ltr" class=""><br class=""><blockquote type="cite" class="">On 24 May 2020, at 12:19, paul tarvydas &lt;<a href="mailto:paultarvydas@gmail.com" class="">paultarvydas@gmail.com</a>&gt; wrote:<br class=""><br class=""></blockquote></div><blockquote type="cite" class=""><div dir="ltr" class="">﻿<div dir="ltr" class=""><div dir="ltr" class="">Hi Gerry<br class=""><br class="">Start with simple experiments, then characterize them.<br class=""><br class="">Answer these questions:<br class=""><br class="">- What is your biggest unknown?<br class=""><br class="">- What is the cheapest experiment you can do to better understand that unknown?<br class=""><br class="">- How can you characterize that experiment and its results?<br class=""><br class="">Then, repeat.<br class=""><br class=""><br class="">For example, I think your biggest unkown is speed.<br class=""><br class="">Speed of what?<br class=""><br class="">Simple experiment - how fast can you pull characters out of SQLite?<br class=""><br class="">Simple experiment - how fast can you push characters down the throat of the link?<br class=""><br class="">Simple experiment(s) - increase the buffer size from single characters to ??? (1K, 100K, 1M, 1G)<br class=""><br class="">Simple experiment - which operating systems / languages / products let you get at SMP?<br class=""><br class="">Simple question - will you need MMAP?&nbsp; What will make this less painful?<br class=""><br class="">Simple characterization (for speed-related unknowns) : profiling.<br class=""><br class="">Simple question - build vs. buy.&nbsp; What can you buy in (from, say, github) that will help you?&nbsp; What do you need to control (i.e. build yourself, instead of githubbing)?<br class=""><br class=""><br class="">My gut says that using C instead of Lisp won't buy you nearly as much as getting rid of the operating system (and SQLite?).<br class=""><br class=""><br class="">When I needed bare-metal speeds, I wrote device drivers.&nbsp; I used Harel Statecharts to avoid spaghetti code.[1]<br class=""><br class="">Simple question - can you find any ethernet stacks written on top of any operating system?&nbsp; Are such stacks written only at the device driver level?&nbsp; How does your problem compare to ethernet speeds?<br class=""><br class=""><br class="">Green threads are closure wannabes. &nbsp;(Greenspun's 10th Rule).<br class=""><br class="">Red threads are green-thread wannabes, with the added complication of Time-Sharing (full preemption).&nbsp; Time-sharing is the reason that multi-tasking has a bad name.&nbsp; AFAIK, Erlang is based on the Time-sharing paradigm (using call-counting, instead of timer interrupts).<br class=""><br class="">Simple question - can you get away with using Bordeaux Threads?&nbsp; It's just an abstraction, a union of what is available in various implementations.&nbsp; Create an experiment.&nbsp; Can you get away with using any Actors libraries?<br class=""><br class=""><br class="">Other places to look: Doug Hoyte's "Anti-Web".&nbsp; A web server that doesn't use O/S threads, AFAIK.<br class=""><br class="">pt<br class=""><br class="">[1] Threads/Processes are state machines.&nbsp; State is scurried away on the stacks.&nbsp; Separate stacks for processes are overheads.&nbsp; O/S'es hide these overheads from you.&nbsp; Separate stacks are OO.&nbsp; OO is a skin on closures.&nbsp; OO targets data only, and screws up control-flow.&nbsp; The worst problem in Software is Design Intent and Structure (aka "Architecture").&nbsp; Speed problems have tools (profilers).&nbsp; Spaghetti Architectures do not have tools, AFAIK.&nbsp; HLLs are the best that we have.&nbsp; And self-discipline.<br class=""></div><div class="gmail_quote"><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"><div lang="EN-US" class=""><div class="gmail-m_-7212283712617684875WordSection1">
</div>
</div>

</blockquote></div></div>
</div></blockquote></div></div></div></div></blockquote></div><br class=""></div></body></html>

                 </article>
                </section>
               </section>
              </section>
             </div>
            </div>
           </body>
          </html>