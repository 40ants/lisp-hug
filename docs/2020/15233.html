<!DOCTYPE html>
<html lang=en>
           <head>
            <meta charset=UTF-8>
            <title>Problem: How to get program's startup directory - And a solution</title>
            <link rel=stylesheet
                  href=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css
                  integrity=sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2
                  crossorigin=anonymous>
            <style>
section.tree {
    padding-left: 2em;
}
section.tree:first-child {
    padding-left: 0;
}
.article-link {
  margin-bottom: 1em;
}
</style>
           </head>
           <body>
            <div class="d-flex justify-content-center">
             <nav
                  class="navbar navbar-light bg-light w-100 mx-5 mb-3">
              <a class=navbar-brand href="/">Lisp HUG Maillist Archive</a>
             </nav>
            </div>
            <div class="d-flex justify-content-center">
             <div class="w-100 mx-5 px-3">
              <section class=tree>
               <article class=email>
                <h1>Problem: How to get program's startup directory - And a solution</h1><html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" xmlns="http://www.w3.org/TR/REC-html40"><head><meta http-equiv=Content-Type content="text/html; charset=us-ascii"><meta name=Generator content="Microsoft Word 15 (filtered medium)"><style><!--
/* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{mso-style-priority:34;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Times New Roman",serif;
	color:windowtext;
	font-weight:normal;
	font-style:normal;}
..MsoChpDefault
	{mso-style-type:export-only;
	font-family:"Calibri",sans-serif;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
/* List Definitions */
@list l0
	{mso-list-id:716003154;
	mso-list-type:hybrid;
	mso-list-template-ids:714401790 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l0:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l0:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level5
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l0:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level8
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
--></style><!--[if gte mso 9]><xml>
<o:shapedefaults v:ext="edit" spidmax="1026" />
</xml><![endif]--><!--[if gte mso 9]><xml>
<o:shapelayout v:ext="edit">
<o:idmap v:ext="edit" data="1" />
</o:shapelayout></xml><![endif]--></head><body lang=EN-US link="#0563C1" vlink="#954F72"><div class=WordSection1><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>I seem to remember one or more posts asking how to get the program&#8217;s startup directory. Seems that it is nice to be able to put your EXE file anywhere. Then on running your EXE, your EXE will create whatever other directories and files it needs relative to itself.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>I think the solution to getting the program&#8217;s startup directory has been to hardcode the full path of wherever you want your EXE to be. If you later want to run from someplace else, you need to recode your DEFCONSTANT to the new location.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>In LispWorks, you can get all the command line arguments as a list. The list is this global sys:*line-arguments-list*. Generally, (first sys:*line-arguments-list*) is the full path to your executable, including the executable. If you do a DELIVER, then run you executable from the command line, then you probably will not get the full path. Instead, you could wind up with just the executable&#8217;s name and EXE extension. What you get is whatever you typed at the command line to invoke your executable. And likely, you changed the current directory to your executable&#8217;s directory, then typed something like<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; my-executable arg-1 arg-2<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>You did not type the full path; therefore, you don&#8217;t get the full path from (first sys:*line-arguments-list*).<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>A problem I have with getting the full path from (first sys:*line-arguments-list*) is that it never works from the Listener in the LispWorks Integrated Development Environment. What you get is LispWorks&#8217;s startup directory. Then when you do a DELIVER, the executable will get its own startup directory. My problem is that the debugging environment won&#8217;t work the same as the runtime environment. And I think LispWorks making the startup directory match the executable&#8217;s would not be so simple. It would not be so simple because of the question, &#8220;What should LispWorks present as the debugging startup directory?&#8221; There&#8217;s no executable yet. Maybe LispWorks could use the directory of one of the source code files? If so, which one?<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>A solution is to get the startup directory from a named pipe. I made a program &#8220;dir-of-&#8221; that creates a named pipe from which a program can get dir-of-&#8217;s startup directory. Then, the program gets the same startup directory from the same place regardless of its running inside LispWorks or running on its own having been delivered. <o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>dir-of- takes a single, optional argument: a suffix to its name for naming the pipe. If you do not provide the suffix, then the name of the pipe is dir-of-.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>I tried running it from a Windows shortcut because you can set up the shortcut to provide a command-line argument. Here is the content of a batch file (dir-of-logger.bat) from which I ran it:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dir-of- logger<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>When I click on the dir-of-logger.bat, these instructions display:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>========== begin display ==========<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>Provides a named-pipe from which programs can read this program's<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>startup directory path.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>Usage:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>&nbsp;&nbsp; dir-of [pipe-name-suffix]<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; where [pipe-name-suffix] is a string appended onto pipe name dir-of-.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>To read this program's startup directory, a program<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>&nbsp;&nbsp;&nbsp;&nbsp; Connects to pipe &quot;dir-of-logger&quot; as client. Reads from pipe &quot;dir-of-logger&quot;. Then closes pipe &quot;dir-of-logger&quot;.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>To see the directory path from a Windows command line, type<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>&nbsp;&nbsp;&nbsp;&nbsp; more &lt; \\.\pipe\\dir-of-logger<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>Reading pipe dir-of-logger will yield<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>&nbsp;&nbsp;&nbsp;&nbsp; D:\Users\rlewi\Documents\Accounting, Indinfer\<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>Press enter to close pipe and exit.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>========== end display ==========<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>I was wondering whether named pipes are used much anymore. At the command line, I typed:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dir \\.\pipe\\*<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>I was surprised to see 89 named pipes listed. Although I am a bit troubled seeing each line listed with &#8220;The parameter is incorrect.&#8221; When I start up dir-of-, I get 90 named pipes listed.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>When I copy and paste from the dir-of- instructions:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; more &lt; \\.\pipe\\dir-of-logger<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>I see the directory<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; D:\Users\rlewi\Documents\Accounting, Indinfer\<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>WHY I AM POSTING<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><ol style='margin-top:0in' start=1 type=1><li class=MsoListParagraph style='margin-left:0in;mso-list:l0 level1 lfo1'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>I am interested in presenting the solution and source code for testing and critique. I likely will benefit from having bugs revealed, a better understanding of Lisp style conventions, and better approaches. I may benefit from corrections of my misunderstandings that may be apparent to others.<br><br><o:p></o:p></span></li><li class=MsoListParagraph style='margin-left:0in;mso-list:l0 level1 lfo1'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>I am interested in contributing the source code to the lisp-hug community for their helping me get started in LispWorks.<br><br><o:p></o:p></span></li><li class=MsoListParagraph style='margin-left:0in;mso-list:l0 level1 lfo1'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>If we get this far and LispWorks is interested, dir-of- could become part of LispWorks&#8217;s distributions.<o:p></o:p></span></li></ol><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>Someone might tell me of a solution that is better than this named pipes solution. <o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>I have not tried this kind of thing before, to donate software with source code. Would anyone tell me how I should do it? Do I need to reference some standard, appropriate license? Would I just ZIP the executable and source code, then attach to an email to lisp-hug@lispworks?<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><i><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>Ron Lewis<o:p></o:p></span></i></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>Baltimore, MD 21215-3551<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>USA<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal><o:p>&nbsp;</o:p></p></div></body></html>

               </article>
               <section class=tree>
                <article class=email>
                 <h1>Re: Problem: How to get program's startup directory - And a solution</h1><div dir="ltr"><div>Hi, <br></div><div><br></div><div>Assuming you are on Windows, you can just call Win32 API function GetModuleFileNameW with NULL pointer as a first argument: <br></div><div><a href="https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-getmodulefilenamea">https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-getmodulefilenamea</a></div><div><br></div><div>You can wrap this call in FLI and get a full path to executable in an easy way:</div><div><br></div><div>(fli:define-foreign-function (get-module-filename &quot;GetModuleFileNameA&quot;) <br>    ((hmodule :pointer) (lpfilename :pointer) (nsize :int32))<br>  :result-type :int32<br>  :calling-convention :stdcall)<br><br>(defun get-program-path ()<br>  (fli:with-dynamic-foreign-objects ()<br>    (let ((lpfilename (fli:allocate-dynamic-foreign-object<br>                       :type &#39;(:unsigned :byte)<br>                       ;; max-path on windows is 4096, so size it bytes 8192<br>                       :nelems 8192)))<br>      (when (&gt; (get-module-filename nil lpfilename 4096) 0)<br>        (fli:convert-from-foreign-string lpfilename)))))</div><div><br></div><div>For me on LispWorks image it returns:</div><div>CL-USER 8 &gt; (get-program-path)<br>&quot;C:\\Program Files (x86)\\LispWorks\\lispworks-7-1-0-x86-win32.exe&quot;</div><div><br></div><div>Br,</div><div>/Alexey<br></div><div><br></div></div><br><div class="gmail_quote"><div dir="ltr" class="gmail_attr">On Mon, May 18, 2020 at 5:47 PM Ron Lewis &lt;<a href="mailto:rlewis-aq@indinfer.com">rlewis-aq@indinfer.com</a>&gt; wrote:<br></div><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"><div lang="EN-US"><div class="gmail-m_-5703995636050513094WordSection1"><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">I seem to remember one or more posts asking how to get the program’s startup directory. Seems that it is nice to be able to put your EXE file anywhere. Then on running your EXE, your EXE will create whatever other directories and files it needs relative to itself.<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">I think the solution to getting the program’s startup directory has been to hardcode the full path of wherever you want your EXE to be. If you later want to run from someplace else, you need to recode your DEFCONSTANT to the new location.<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">In LispWorks, you can get all the command line arguments as a list. The list is this global sys:*line-arguments-list*. Generally, (first sys:*line-arguments-list*) is the full path to your executable, including the executable. If you do a DELIVER, then run you executable from the command line, then you probably will not get the full path. Instead, you could wind up with just the executable’s name and EXE extension. What you get is whatever you typed at the command line to invoke your executable. And likely, you changed the current directory to your executable’s directory, then typed something like<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">          my-executable arg-1 arg-2<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">You did not type the full path; therefore, you don’t get the full path from (first sys:*line-arguments-list*).<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">A problem I have with getting the full path from (first sys:*line-arguments-list*) is that it never works from the Listener in the LispWorks Integrated Development Environment. What you get is LispWorks’s startup directory. Then when you do a DELIVER, the executable will get its own startup directory. My problem is that the debugging environment won’t work the same as the runtime environment. And I think LispWorks making the startup directory match the executable’s would not be so simple. It would not be so simple because of the question, “What should LispWorks present as the debugging startup directory?” There’s no executable yet. Maybe LispWorks could use the directory of one of the source code files? If so, which one?<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">A solution is to get the startup directory from a named pipe. I made a program “dir-of-” that creates a named pipe from which a program can get dir-of-’s startup directory. Then, the program gets the same startup directory from the same place regardless of its running inside LispWorks or running on its own having been delivered. <u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">dir-of- takes a single, optional argument: a suffix to its name for naming the pipe. If you do not provide the suffix, then the name of the pipe is dir-of-.<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">I tried running it from a Windows shortcut because you can set up the shortcut to provide a command-line argument. Here is the content of a batch file (dir-of-logger.bat) from which I ran it:<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">          dir-of- logger<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">When I click on the dir-of-logger.bat, these instructions display:<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">========== begin display ==========<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">Provides a named-pipe from which programs can read this program&#39;s<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">startup directory path.<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">Usage:<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">   dir-of [pipe-name-suffix]<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">          where [pipe-name-suffix] is a string appended onto pipe name dir-of-.<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">To read this program&#39;s startup directory, a program<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">     Connects to pipe &quot;dir-of-logger&quot; as client. Reads from pipe &quot;dir-of-logger&quot;. Then closes pipe &quot;dir-of-logger&quot;.<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">To see the directory path from a Windows command line, type<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">     more &lt; \\.\pipe\\dir-of-logger<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">Reading pipe dir-of-logger will yield<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">     D:\Users\rlewi\Documents\Accounting, Indinfer\<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">Press enter to close pipe and exit.<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">========== end display ==========<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">I was wondering whether named pipes are used much anymore. At the command line, I typed:<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">          dir \\.\pipe\\*<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">I was surprised to see 89 named pipes listed. Although I am a bit troubled seeing each line listed with “The parameter is incorrect.” When I start up dir-of-, I get 90 named pipes listed.<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">When I copy and paste from the dir-of- instructions:<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">          more &lt; \\.\pipe\\dir-of-logger<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">I see the directory<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">          D:\Users\rlewi\Documents\Accounting, Indinfer\<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">WHY I AM POSTING<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><ol style="margin-top:0in" type="1" start="1"><li class="gmail-m_-5703995636050513094MsoListParagraph" style="margin-left:0in"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">I am interested in presenting the solution and source code for testing and critique. I likely will benefit from having bugs revealed, a better understanding of Lisp style conventions, and better approaches. I may benefit from corrections of my misunderstandings that may be apparent to others.<br><br><u></u><u></u></span></li><li class="gmail-m_-5703995636050513094MsoListParagraph" style="margin-left:0in"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">I am interested in contributing the source code to the lisp-hug community for their helping me get started in LispWorks.<br><br><u></u><u></u></span></li><li class="gmail-m_-5703995636050513094MsoListParagraph" style="margin-left:0in"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">If we get this far and LispWorks is interested, dir-of- could become part of LispWorks’s distributions.<u></u><u></u></span></li></ol><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">Someone might tell me of a solution that is better than this named pipes solution. <u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">I have not tried this kind of thing before, to donate software with source code. Would anyone tell me how I should do it? Do I need to reference some standard, appropriate license? Would I just ZIP the executable and source code, then attach to an email to lisp-hug@lispworks?<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><i><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">Ron Lewis<u></u><u></u></span></i></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">Baltimore, MD 21215-3551<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif">USA<u></u><u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><span style="font-size:12pt;font-family:&quot;Times New Roman&quot;,serif"><u></u> <u></u></span></p><p class="MsoNormal"><u></u> <u></u></p></div></div></blockquote></div>


                </article>
               </section>
              </section>
             </div>
            </div>
           </body>
          </html>