<!DOCTYPE html>
<html lang=en>
           <head>
            <meta charset=UTF-8>
            <title>Fw: Problem with COM and LWW 5.1.2</title>
            <meta name=viewport
                  content="width=device-width, initial-scale=1.0">
            <link rel=stylesheet
                  href=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css
                  integrity=sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2
                  crossorigin=anonymous>
            <style>
section.tree {
    padding-left: 2em;
}
section.tree:first-child {
    padding-left: 0;
}
.article-link {
  margin-bottom: 1em;
}
</style>
<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9X3G9MMWZP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9X3G9MMWZP');
</script>

           </head>
           <body>
            <header class="d-flex justify-content-center">
             <nav
                  class="navbar navbar-light bg-light w-100 mx-5 mb-3">
              <a class=navbar-brand href="/">Lisp HUG Maillist Archive</a>
             </nav>
            </header>
            <div class="d-flex justify-content-center">
             <div class="w-100 mx-5 px-3">
              <section class=tree>
               <article class=email>
                <h1>Fw: Problem with COM and LWW 5.1.2</h1>
                <pre>
Thanks Martin.

Sorry for posting from the wrong address. I'm forwarding this to the list 
anyway for the record.

I' be grateful if anybody has a clever idea to investigate the problem.

I can add the following :
- the mail store has about 50000 messages
- the problem is not about the particular message where OpenMessage() fails, 
because I removed the first message showing the problem and it still happens 
after the very same number of messages, but on a different one.

Best regards,

Fabrice

----- Original Message ----- 
From: "Martin Simmons" &lt;martin@lispworks.com&gt
To: &lt;fabrice.popineau@free.fr&gt
Cc: &lt;lisp-hug-approval@lispworks.com&gt
Sent: Friday, May 01, 2009 5:10 PM
Subject: Re: Problem with COM and LWW 5.1.2


&gt Hi Fabrice,
&gt
&gt Your message to lisp-hug bounced because the address 
&gt fabrice.popineau@free.fr
&gt is not subscribed to the list.
&gt
&gt Regarding your original question, I don't see anything wrong with your
&gt function message-extract-headers.
&gt
&gt -- 
&gt Martin Simmons
&gt LispWorks Ltd
&gt http://www.lispworks.com/
&gt
&gt
&gt
&gt --- Original message ---
&gt From: "Fabrice Popineau" &lt;fabrice.popineau@free.fr&gt
&gt To: &lt;lisp-hug@lispworks.com&gt
&gt Subject: Problem with COM and LWW 5.1.2
&gt Date: Fri, 1 May 2009 09:37:35 +0200
&gt
&gt Hi,
&gt
&gt I'm writing some Lisp code to help me sort out my mail messages better
&gt than Windows Mail (formerly Outlook Express) is able to do. There is a
&gt COM interface exposed for the Mail Store. The interfaces are
&gt IStoreNamespace and IStoreFolder.
&gt
&gt I can recursively walk the folder and list the messages. Things are
&gt going wrong when I'm actually trying to open the messages.
&gt
&gt If I walk the messages and just get their information as returned by
&gt GetMessageProps(), eveyrthing is ok and I can walk all my mail store.
&gt
&gt If I add the following :
&gt
&gt (defun message-extract-headers (store-folder message-id)
&gt   (multiple-value-bind (return-value stream)
&gt       (com:call-com-interface ((interface store-folder) i-store-folder 
&gt open-message)
&gt          message-id 'i-stream)
&gt     (com:check-hresult return-value "open-message")
&gt     (com:release stream)
&gt    nil))
&gt
&gt ie : doing nothing but opening the message and releasing the stream, the
&gt program stops after 10k messages (exactly : 10830 messages), with an
&gt error being unable to open the next message. I'm a bit stuck : what can
&gt I do to it? Is it possible there is a memory leak (or handle leak)
&gt happening behind ? Any idea on how to overcome the problem ?
&gt
&gt I want to open the messages to grab headers not directly exposed by the
&gt IStoreFolder api.
&gt
&gt Thanks for any help,
&gt
&gt Fabrice
&gt
&gt 



</pre>
               </article>
              </section>
             </div>
            </div>
            <footer class="d-flex justify-content-center">
             <div>
              Updated at: 2020-12-10 08:41 UTC
             </div>
            </footer>
           </body>
          </html>