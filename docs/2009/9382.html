<!DOCTYPE html>
<html lang=en>
           <head>
            <meta charset=UTF-8>
            <title>OpenSSL and Multiple Threads?</title>
            <link rel=stylesheet
                  href=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css
                  integrity=sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2
                  crossorigin=anonymous>
            <style>
section.tree {
    padding-left: 2em;
}
section.tree:first-child {
    padding-left: 0;
}
.article-link {
  margin-bottom: 1em;
}
</style>
<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9X3G9MMWZP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9X3G9MMWZP');
</script>

           </head>
           <body>
            <header class="d-flex justify-content-center">
             <nav
                  class="navbar navbar-light bg-light w-100 mx-5 mb-3">
              <a class=navbar-brand href="/">Lisp HUG Maillist Archive</a>
             </nav>
            </header>
            <div class="d-flex justify-content-center">
             <div class="w-100 mx-5 px-3">
              <section class=tree>
               <article class=email>
                <h1>OpenSSL and Multiple Threads?</h1>
                <pre>
Hi,

I have an application attempting to use SSL connections. I have  
verified that the Lispworks demo code runs perfectly. And I even  
recoded it to a binary stream version, instead of text based, and that  
runs fine too.

The only difference between the demo and my application is that I  
spawn off a separate reader thread for the socket stream on both  
client and server sides so that full-duplex communications can occur  
between them. The original thread that opened the socket stream  
remains only a writer, and the reader thread performs only reading.  
Both operate on the same stream object. This works just fine when not  
using an SSL connection.

When I try to open an SSL connection between client and server I get  
numerous different and random SSL errors showing up during the  
connection attempt, mostly on the client side, but sometimes on the  
server side too. Errors from SSL are complaining about unexpected  
codes, wrong versions, blocks too large, etc. Quite a random  
collection, and hardly repeatable. The socket shuts down after this,  
and I never even get the chance to exchange a hello between client and  
server.

So I'm beginning to get the idea that OpenSSL is not reentrant, and is  
meant for a conversational style where messages are followed by  
replies in strict cyclic order. That's the way the LW demos behave and  
they work just fine. Does anyone out there have any knowledge about  
this situation with OpenSSL?

Dr. David McClain
dbm@refined-audiometrics.com




</pre>
               </article>
              </section>
             </div>
            </div>
            <footer class="d-flex justify-content-center">
             <div>
              Updated at: 2020-12-07 08:36 UTC
             </div>
            </footer>
           </body>
          </html>