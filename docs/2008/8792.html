<!DOCTYPE html>
<html lang=en>
           <head>
            <meta charset=UTF-8>
            <title>RE: Query Ctrl or Shift keys only?</title>
            <meta name=viewport
                  content="width=device-width, initial-scale=1.0">
            <link rel=stylesheet
                  href=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css
                  integrity=sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2
                  crossorigin=anonymous>
            <style>
section.tree {
    padding-left: 2em;
}
section.tree:first-child {
    padding-left: 0;
}
.article-link {
  margin-bottom: 1em;
}
</style>
<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9X3G9MMWZP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9X3G9MMWZP');
</script>

           </head>
           <body>
            <header class="d-flex justify-content-center">
             <nav
                  class="navbar navbar-light bg-light w-100 mx-5 mb-3">
              <a class=navbar-brand href="/">Lisp HUG Maillist Archive</a>
             </nav>
            </header>
            <div class="d-flex justify-content-center">
             <div class="w-100 mx-5 px-3">
              <section class=tree>
               <article class=email>
                <h1>RE: Query Ctrl or Shift keys only?</h1>
                <pre>
-----Original Message-----
From: Andreas Thiele [mailto:andreas@atp-media.de] 
Sent: Tuesday, November 18, 2008 10:04 AM
To: 'Martin Simmons'
Subject: RE: Query Ctrl or Shift keys only?




&gt -----Original Message-----
&gt From: owner-lisp-hug@lispworks.com
&gt [mailto:owner-lisp-hug@lispworks.com] On Behalf Of Martin Simmons
&gt Sent: Monday, November 17, 2008 3:15 PM
&gt To: lisp-hug@lispworks.com
&gt Subject: Re: Query Ctrl or Shift keys only?
&gt 
&gt 
&gt 
&gt &gt&gt&gt&gt&gt On Thu, 13 Nov 2008 12:07:58 +0100, Andreas Thiele said:
&gt &gt 
&gt &gt Hi All,
&gt &gt 
&gt &gt after playing with gesture-specs I do not succeed to query
&gt the control
&gt &gt or shift keys unless another meaningful key is pressed.
&gt &gt 
&gt &gt Is it possible to know if the shift or control key is down
&gt (or up) in
&gt &gt LispWorks?
&gt &gt 
&gt &gt Any hint or hack welcome.
&gt 
&gt The win32 API approach will work, though it uses undocumented
&gt APIs in LispWorks so is closer to hack than hint :-)
&gt 
&gt In what situations do you need to find the state of control or shift?
&gt 
&gt --
&gt Martin Simmons
&gt LispWorks Ltd
&gt http://www.lispworks.com/
&gt 

Hi Martin,

thanks, I need it when drag and drop just startet to decise whether the user wants a copy or move operation.


Andreas


</pre>
               </article>
               <section class=tree>
                <article class=email>
                 <h1>Re: Query Ctrl or Shift keys only?</h1>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html;charset=ISO-8859-1" http-equiv="Content-Type">
  <title></title>
</head>
<body bgcolor="#ffffff" text="#000000">
<br>
<br>
<blockquote cite="mid:24EB1FDB5B8A4C6BBDF6AD3C91BE41C0@atphome2"
 type="cite">
  <blockquote type="cite">
    <pre wrap="">The win32 API approach will work, though it uses undocumented
APIs in LispWorks so is closer to hack than hint :-)

In what situations do you need to find the state of control or shift?

--
Martin Simmons
LispWorks Ltd
<a class="moz-txt-link-freetext" href="http://www.lispworks.com/">http://www.lispworks.com/</a>

    </pre>
  </blockquote>
  <pre wrap=""><!---->
Hi Martin,

thanks, I need it when drag and drop just startet to decise whether the user wants a copy or move operation.


Andreas
  </pre>
</blockquote>
<br>
Can't you use input-model callbacks like ((:motion :shift)
shift-motion-callback) and ((:motion :control) control-motion-callback)
for that?<br>
<br>
Mitch<br>
</body>
</html>



                </article>
                <section class=tree>
                 <article class=email>
                  <h1>RE: Query Ctrl or Shift keys only?</h1><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=us-ascii">
<TITLE>Nachricht</TITLE>

<META content="MSHTML 6.00.6000.16735" name=GENERATOR></HEAD>
<BODY text=#000000 bgColor=#ffffff>
<DIV><FONT face=Arial color=#0000ff size=2></FONT>&nbsp;</DIV>
<BLOCKQUOTE 
style="PADDING-LEFT: 5px; MARGIN-LEFT: 5px; BORDER-LEFT: #0000ff 2px solid; MARGIN-RIGHT: 0px">
  <DIV></DIV>
  <DIV class=OutlookMessageHeader lang=de dir=ltr align=left><FONT face=Tahoma 
  size=2>-----Original Message-----<BR><B>From:</B> Mitch Berkson 
  [mailto:mitch@bermita.com] <BR><B>Sent:</B> Tuesday, November 18, 2008 2:19 
  PM<BR><B>To:</B> Andreas Thiele<BR><B>Cc:</B> 
  lisp-hug@lispworks.com<BR><B>Subject:</B> Re: Query Ctrl or Shift keys 
  only?<BR><BR></FONT></DIV><BR><BR>
  <BLOCKQUOTE cite=mid:24EB1FDB5B8A4C6BBDF6AD3C91BE41C0@atphome2 type="cite">
    <BLOCKQUOTE type="cite"><PRE wrap="">The win32 API approach will work, though it uses undocumented
APIs in LispWorks so is closer to hack than hint :-)

In what situations do you need to find the state of control or shift?

--
Martin Simmons
LispWorks Ltd
<A class=moz-txt-link-freetext href="http://www.lispworks.com/">http://www.lispworks.com/</A>

    </PRE></BLOCKQUOTE><PRE wrap=""><!---->
Hi Martin,

thanks, I need it when drag and drop just startet to decise whether the user wants a copy or move operation.


Andreas
  </PRE></BLOCKQUOTE>
  <DIV><BR>Can't you use input-model callbacks like ((:motion :shift) 
  shift-motion-callback) and ((:motion :control) control-motion-callback) for 
  that?<BR><BR>Mitch<SPAN class=250563814-18112008><FONT face=Arial 
  color=#0000ff size=2>&nbsp;</FONT></SPAN><SPAN 
  class=250563814-18112008>&nbsp;</SPAN><BR><SPAN class=250563814-18112008><FONT 
  face=Arial color=#0000ff size=2>&nbsp;</FONT></SPAN></DIV>
  <DIV><SPAN class=250563814-18112008><FONT face=Arial color=#0000ff size=2>IIRC 
  the input-model callbacks don't work if you are in a drag-and-drop callback. I 
  tried it an solved the issue with the win32 call.</FONT></SPAN></DIV>
  <DIV><SPAN class=250563814-18112008><FONT face=Arial color=#0000ff 
  size=2></FONT></SPAN>&nbsp;</DIV>
  <DIV><SPAN class=250563814-18112008><FONT face=Arial color=#0000ff 
  size=2>Andreas</FONT></SPAN></DIV>
  <DIV><SPAN class=250563814-18112008><FONT face=Arial color=#0000ff 
  size=2></FONT></SPAN>&nbsp;</DIV></BLOCKQUOTE></BODY></HTML>


                 </article>
                 <section class=tree>
                  <article class=email>
                   <h1>Re: Query Ctrl or Shift keys only?</h1>
                   <pre>
&gt&gt I need it when drag and drop just startet to decise whether the  
&gt&gt user wants a copy or move operation

Maybe you can do that in the drop-callback of a capi::simple-pane,  
using capi:drop-object-allows-drop-effect-p and capi:drop-object-drop- 
effect.
This will behave and update the cursor accordingly to the OS on which  
you are running LW.


(defun my-drop-callback (self drop-object stage)
   (flet ((set-effect-for-operation (drop-object)
            (dolist (effect '(:move :copy :link :generic))
              (when (capi:drop-object-allows-drop-effect-p drop-object  
effect)
                (setf (capi:drop-object-drop-effect drop-object) effect)
                (return t)))))
       ;;; set-effect-for-operation makes (capi:drop-object-drop- 
effect drop-object) correspond to the type of action (copy, move, etc.)
       ;;; it is called in the various stages of a d&amp;d process :
       (case stage
         (:formats
          ; set d&amp;d formats
          (capi:set-drop-object-supported-formats drop-object  
'(:string :value :my-object :filename-list)))
         (:enter
          (set-effect-for-operation drop-object)
          ; (... do something when drag enters a pane ...)
	)
         (:leave
          (set-effect-for-operation drop-object)
         ; (... do something when drag leaves a pane ...)
	)
         (:drag
          (set-effect-for-operation drop-object))
        (:drop
              (set-effect-for-operation drop-object)
              (if (equal (capi:drop-object-drop-effect drop- 
object) :copy) (print "copy") (print "move"))
              (setf (capi:drop-object-drop-effect drop-object) nil))
        )))




</pre>
                  </article>
                 </section>
                </section>
               </section>
              </section>
             </div>
            </div>
            <footer class="d-flex justify-content-center">
             <div>
              Updated at: 2020-12-10 08:41 UTC
             </div>
            </footer>
           </body>
          </html>