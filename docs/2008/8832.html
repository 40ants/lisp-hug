<!DOCTYPE html>
<html lang=en>
           <head>
            <meta charset=UTF-8>
            <title>MOP Multiple Metaclass Inheritance?</title>
            <meta name=viewport
                  content="width=device-width, initial-scale=1.0">
            <link rel=stylesheet
                  href=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css
                  integrity=sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2
                  crossorigin=anonymous>
            <style>
section.tree {
    padding-left: 2em;
}
section.tree:first-child {
    padding-left: 0;
}
.article-link {
  margin-bottom: 1em;
}
</style>
<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9X3G9MMWZP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9X3G9MMWZP');
</script>

           </head>
           <body>
            <header class="d-flex justify-content-center">
             <nav
                  class="navbar navbar-light bg-light w-100 mx-5 mb-3">
              <a class=navbar-brand href="/">Lisp HUG Maillist Archive</a>
             </nav>
            </header>
            <div class="d-flex justify-content-center">
             <div class="w-100 mx-5 px-3">
              <section class=tree>
               <article class=email>
                <h1>MOP Multiple Metaclass Inheritance?</h1><html><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; ">
Hi all,<div><br></div><div>Been doing some persistent object stuff here, and MOP works like a champ. But I have run into a situation where some objects contain persistent slots AND some slots that are "virtual" in the sense that their reader returns values computed on the basis of the values contained in other slots, some of which are persistent.</div><div><br></div><div>So I defined a PERSISTENT-METACLASS to handle objects containing persistent slots, and a COMPUTABLE-METACLASS to handle objects containing computable slots. Both work great. </div><div><br></div><div>But now, in order to produce objects that contain both kinds of slots, I had to stack the metaclasses so that COMPUTABLE-METACLASS inherits from STANDARD-CLASS, and then have PERSISTENT-METACLASS inherit from COMPUTABLE-METACLASS -- even though there is really nothing about the two metaclasses that should warrant an inheritance relationship between them.<br><br></div><div><font class="Apple-style-span" face="Courier">;; --------------------------------------------------------------</font></div><div><font class="Apple-style-span" face="Courier">;; metaclass of objects that might contain computed slots</font></div><div><font class="Apple-style-span" face="Courier"><br></font></div><div><font class="Apple-style-span" face="Courier">(defclass computed-metaclass (#+:LISPWORKS clos:standard-class</font></div><div><font class="Apple-style-span" face="Courier">                              #+:ALLEGRO clos::standard-class)</font></div><div><font class="Apple-style-span" face="Courier">  ())</font></div><div><font class="Apple-style-span" face="Courier"><br></font></div><div><font class="Apple-style-span" face="Courier">;; --------------------------------------------------------------</font></div><div><font class="Apple-style-span" face="Courier">;; metaclass of objects that might contain persistent slots</font></div><div><font class="Apple-style-span" face="Courier"><br></font></div><div><font class="Apple-style-span" face="Courier">(defclass persistent-metaclass (computed-metaclass) ;; ??</font></div><div><font class="Apple-style-span" face="Courier">  ())</font></div><div><br></div><div><div><font class="Apple-style-span" face="Courier">;; --------------------------------------------------------------</font></div><div><font class="Apple-style-span" face="Courier"><br></font></div></div><div>We can do multiple inheritance at the CLOS level. But what about at the MOP Meta-level where we have to declare our new class definition's :metaclass ??</div><div><br><div> <span class="Apple-style-span" style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; -webkit-text-decorations-in-effect: none; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0; "><span class="Apple-style-span" style="border-collapse: separate; -webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; -webkit-text-decorations-in-effect: none; text-indent: 0px; -webkit-text-size-adjust: auto; text-transform: none; orphans: 2; white-space: normal; widows: 2; word-spacing: 0px; "><span class="Apple-style-span" style="border-collapse: separate; -webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; -webkit-text-decorations-in-effect: none; text-indent: 0px; -webkit-text-size-adjust: auto; text-transform: none; orphans: 2; white-space: normal; widows: 2; word-spacing: 0px; "><span class="Apple-style-span" style="border-collapse: separate; -webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; -webkit-text-decorations-in-effect: none; text-indent: 0px; -webkit-text-size-adjust: auto; text-transform: none; orphans: 2; white-space: normal; widows: 2; word-spacing: 0px; "><span class="Apple-style-span" style="border-collapse: separate; -webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; -webkit-text-decorations-in-effect: none; text-indent: 0px; -webkit-text-size-adjust: auto; text-transform: none; orphans: 2; white-space: normal; widows: 2; word-spacing: 0px; "><span class="Apple-style-span" style="border-collapse: separate; -webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; -webkit-text-decorations-in-effect: none; text-indent: 0px; -webkit-text-size-adjust: auto; text-transform: none; orphans: 2; white-space: normal; widows: 2; word-spacing: 0px; "><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">Dr. David McClain</div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">Chief Technical Officer</div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">Refined Audiometrics Laboratory</div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">4391 N. Camino Ferreo</div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">Tucson, AZ  85750</div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; font: normal normal normal 12px/normal Helvetica; min-height: 14px; "><br></div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">email: <a href="mailto:dbm@refined-audiometrics.com">dbm@refined-audiometrics.com</a></div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">phone: 1.520.390.3995</div><div style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; ">web: <a href="http://www.refined-audiometrics.com">http://www.refined-audiometrics.com</a></div><br class="Apple-interchange-newline"></span><span></span></span></span></span></span></span><br class="Apple-interchange-newline"> </div><br></div></body></html>

               </article>
               <section class=tree>
                <article class=email>
                 <h1>Re: MOP Multiple Metaclass Inheritance?</h1><html><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; "><br><div><div>On 2 Dec 2008, at 05:39, David McClain wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; "> Hi all,<div><br></div><div>Been doing some persistent object stuff here, and MOP works like a champ. But I have run into a situation where some objects contain persistent slots AND some slots that are "virtual" in the sense that their reader returns values computed on the basis of the values contained in other slots, some of which are persistent.</div><div><br></div><div>So I defined a PERSISTENT-METACLASS to handle objects containing persistent slots, and a COMPUTABLE-METACLASS to handle objects containing computable slots. Both work great.&nbsp;</div><div><br></div><div>But now, in order to produce objects that contain both kinds of slots, I had to stack the metaclasses so that COMPUTABLE-METACLASS inherits from STANDARD-CLASS, and then have PERSISTENT-METACLASS inherit from COMPUTABLE-METACLASS -- even though there is really nothing about the two metaclasses that should warrant an inheritance relationship between them.<br><br></div><div><font class="Apple-style-span" face="Courier">;; --------------------------------------------------------------</font></div><div><font class="Apple-style-span" face="Courier">;; metaclass of objects that might contain computed slots</font></div><div><font class="Apple-style-span" face="Courier"><br></font></div><div><font class="Apple-style-span" face="Courier">(defclass computed-metaclass (#+:LISPWORKS clos:standard-class</font></div><div><font class="Apple-style-span" face="Courier">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#+:ALLEGRO clos::standard-class)</font></div><div><font class="Apple-style-span" face="Courier">&nbsp;&nbsp;())</font></div><div><font class="Apple-style-span" face="Courier"><br></font></div><div><font class="Apple-style-span" face="Courier">;; --------------------------------------------------------------</font></div><div><font class="Apple-style-span" face="Courier">;; metaclass of objects that might contain persistent slots</font></div><div><font class="Apple-style-span" face="Courier"><br></font></div><div><font class="Apple-style-span" face="Courier">(defclass persistent-metaclass (computed-metaclass) ;; ??</font></div><div><font class="Apple-style-span" face="Courier">&nbsp;&nbsp;())</font></div><div><br></div><div><div><font class="Apple-style-span" face="Courier">;; --------------------------------------------------------------</font></div><div><font class="Apple-style-span" face="Courier"><br></font></div></div><div>We can do multiple inheritance at the CLOS level. But what about at the MOP Meta-level where we have to declare our new class definition's :metaclass ??</div></div></blockquote><br></div><div>Easy:</div><div><br></div><div>(defclass computed-class (standard-class) ()) ;; don't say 'metaclass' here, we're already at the metalevel ;)</div><div>(defclass persistent-class (standard-class) ())</div><div><br></div><div>...and then...</div><div><br></div><div>(defclass computed-persistent-class (computed-class persistent-class) ())</div><div><br></div><div>...and later...</div><div><br></div><div>(defclass person-object #|!!!|# (...)</div><div>&nbsp;&nbsp;()</div><div>&nbsp;&nbsp;(:metaclass computed-persistent-class))</div><div><br></div><div>It would have been nice if one could say this instead:</div><div><br></div><div>(defclass person-object ()</div><div>&nbsp;&nbsp;()</div><div>&nbsp;&nbsp;(:metaclasses computed-class persistent-class))</div><div><br></div><div>However, it's unlikely that such automatic compositions of metaclasses automagically work - you typically have to do some non-trivial adaptations, for example for the slot-value-using-class protocol, etc.</div><div><br></div><div>You can take a look at the ContextL source code, where I use this kind of manual metaclass composition to define the new features separately from each other.</div><div><br></div><div><br></div><div>Pascal</div><div><br></div><div apple-content-edited="true"> <span class="Apple-style-span" style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; -webkit-text-decorations-in-effect: none; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0; "><div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; "><span class="Apple-style-span" style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; -webkit-text-decorations-in-effect: none; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; "><div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; "><span class="Apple-style-span" style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; -webkit-text-decorations-in-effect: none; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; "><div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; "><span class="Apple-style-span" style="border-collapse: separate; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; -webkit-text-decorations-in-effect: none; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; "><div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; "><span class="Apple-style-span" style="border-collapse: separate; -webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; -webkit-text-decorations-in-effect: none; text-indent: 0px; -webkit-text-size-adjust: auto; text-transform: none; orphans: 2; white-space: normal; widows: 2; word-spacing: 0px; "><div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; "><div>--&nbsp;</div><div>Pascal Costanza, mailto:pc@p-cos.net, <a href="http://p-cos.net">http://p-cos.net</a></div><div>Vrije Universiteit Brussel, Programming Technology Lab</div><div>Pleinlaan 2, B-1050 Brussel, Belgium</div><div><br class="khtml-block-placeholder"></div><div><br class="khtml-block-placeholder"></div><br class="Apple-interchange-newline"></div></span></div></span><br class="Apple-interchange-newline"></div></span><br class="Apple-interchange-newline"></div></span><br class="Apple-interchange-newline"></div></span><br class="Apple-interchange-newline"> </div><br></body></html>

                </article>
               </section>
              </section>
             </div>
            </div>
            <footer class="d-flex justify-content-center">
             <div>
              Updated at: 2020-12-10 08:41 UTC
             </div>
            </footer>
           </body>
          </html>