<!DOCTYPE html>
<html lang=en>
           <head>
            <meta charset=UTF-8>
            <title>win32 DDE/Double click</title>
            <link rel=stylesheet
                  href=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css
                  integrity=sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2
                  crossorigin=anonymous>
            <style>
section.tree {
    padding-left: 2em;
}
section.tree:first-child {
    padding-left: 0;
}
.article-link {
  margin-bottom: 1em;
}
</style>
<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9X3G9MMWZP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9X3G9MMWZP');
</script>

           </head>
           <body>
            <header class="d-flex justify-content-center">
             <nav
                  class="navbar navbar-light bg-light w-100 mx-5 mb-3">
              <a class=navbar-brand href="/">Lisp HUG Maillist Archive</a>
             </nav>
            </header>
            <div class="d-flex justify-content-center">
             <div class="w-100 mx-5 px-3">
              <section class=tree>
               <article class=email>
                <h1>win32 DDE/Double click</h1>
                <pre>
I am trying to get my windows app (exe) open its .foo files from
explorer.  I used the example provided, and set up a DDE server.  This
works fine if the program is running -- it gets the filename.  If it
is not running, the shell falls back to running "myexe.exe %1" which
also runs OK.  But in the second case I get the "Cannot find the file
"filename.foo" (or one of its components)..."  dialog along with the
working program with the proper file in it.

A search at MSDN didn't tell me when exactly this message pops up, but
It told me enough for me to assume that the initial DDE connect fails,
the shell runs the program, the second DDE connect also fails
triggering the message.  I start the DDE server from an
(excute-with-context ...) form within the context of  main capi interface 
as early in the code as possible.  

Does this sound familiar to anyone?  I'll try to isolate this some
more and maybe work around it by turning off DDE from the shell and
just running the program which then would check for a second instance
and do teh right DDE thing.  But I wanted to check first, if there was
a simple thing I was missing.  (The code is almost identical to the
example, LWpro 4.3.7).

thanks,

BM




</pre>
               </article>
               <section class=tree>
                <article class=email>
                 <h1>Re: win32 DDE/Double click</h1>
                 <pre>This is a LispWorks problem as I ran into it recently.  Check with 
Xanalys for a private patch that will fix the problem.

As a workaround, deliver your application without a splash screen.

   - Gary Palter
     Principal Software Engineer
     Clozure Associates
________________________________________________________________________

At 12:02 AM +0200 11/5/04, Bulent Murtezaoglu wrote:
&gtI am trying to get my windows app (exe) open its .foo files from
&gtexplorer.  I used the example provided, and set up a DDE server.  This
&gtworks fine if the program is running -- it gets the filename.  If it
&gtis not running, the shell falls back to running "myexe.exe %1" which
&gtalso runs OK.  But in the second case I get the "Cannot find the file
&gt"filename.foo" (or one of its components)..."  dialog along with the
&gtworking program with the proper file in it.
&gt
&gtA search at MSDN didn't tell me when exactly this message pops up, but
&gtIt told me enough for me to assume that the initial DDE connect fails,
&gtthe shell runs the program, the second DDE connect also fails
&gttriggering the message.  I start the DDE server from an
&gt(excute-with-context ...) form within the context of  main capi interface
&gtas early in the code as possible. 
&gt
&gtDoes this sound familiar to anyone?  I'll try to isolate this some
&gtmore and maybe work around it by turning off DDE from the shell and
&gtjust running the program which then would check for a second instance
&gtand do teh right DDE thing.  But I wanted to check first, if there was
&gta simple thing I was missing.  (The code is almost identical to the
&gtexample, LWpro 4.3.7).
&gt
&gtthanks,
&gt
&gtBM


</pre>
                </article>
               </section>
              </section>
             </div>
            </div>
            <footer class="d-flex justify-content-center">
             <div>
              Updated at: 2020-12-07 08:50 UTC
             </div>
            </footer>
           </body>
          </html>