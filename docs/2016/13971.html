<!DOCTYPE html>
<html lang=en>
           <head>
            <meta charset=UTF-8>
            <title>fli:register-module &amp; dll dependencies</title>
            <link rel=stylesheet
                  href=https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css
                  integrity=sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2
                  crossorigin=anonymous>
            <style>
section.tree {
    padding-left: 2em;
}
section.tree:first-child {
    padding-left: 0;
}
.article-link {
  margin-bottom: 1em;
}
</style>
<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9X3G9MMWZP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9X3G9MMWZP');
</script>

           </head>
           <body>
            <header class="d-flex justify-content-center">
             <nav
                  class="navbar navbar-light bg-light w-100 mx-5 mb-3">
              <a class=navbar-brand href="/">Lisp HUG Maillist Archive</a>
             </nav>
            </header>
            <div class="d-flex justify-content-center">
             <div class="w-100 mx-5 px-3">
              <section class=tree>
               <article class=email>
                <h1>fli:register-module &amp; dll dependencies</h1><html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" xmlns="http://www.w3.org/TR/REC-html40"><head><meta http-equiv=Content-Type content="text/html; charset=utf-8"><meta name=Generator content="Microsoft Word 15 (filtered medium)"><style><!--
/* Font Definitions */
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{mso-style-priority:34;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
..MsoChpDefault
	{mso-style-type:export-only;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:70.85pt 70.85pt 70.85pt 70.85pt;}
div.WordSection1
	{page:WordSection1;}
/* List Definitions */
@list l0
	{mso-list-id:1154762742;
	mso-list-type:hybrid;
	mso-list-template-ids:-343085104 -1 67895299 67895301 67895297 67895299 67895301 67895297 67895299 67895301;}
@list l0:level1
	{mso-level-start-at:0;
	mso-level-number-format:bullet;
	mso-level-text:-;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	font-family:"Calibri",sans-serif;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
@list l0:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	font-family:"Courier New";}
@list l0:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	font-family:Wingdings;}
@list l0:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	font-family:Symbol;}
@list l0:level5
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	font-family:"Courier New";}
@list l0:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	font-family:Wingdings;}
@list l0:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	font-family:Symbol;}
@list l0:level8
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	font-family:"Courier New";}
@list l0:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	font-family:Wingdings;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
--></style></head><body lang=FR><div class=WordSection1><p class=MsoNormal>Hello,</p><p class=MsoNormal><o:p>&nbsp;</o:p></p><p class=MsoNormal>I’m trying to register a foreign language interface for the libpq.dll of PostgreSQL 9.5 – 32bits.</p><p class=MsoNormal>This dll seems to depend on 4 other dlls: libeay32.dll, libiconv-2.dll, libintl-8.dll, ssleay32.dll.</p><p class=MsoNormal>All dlls can be found together in the same folder &lt;PostgreSQL Folder&gt;/9.1/bin.</p><p class=MsoNormal><o:p>&nbsp;</o:p></p><p class=MsoNormal>I managed to make it work by copying all 5 dlls to a seperate folder then adding this folder’s path to the PATH environement variable of my system. The command is then simply&nbsp;:</p><p class=MsoNormal>(fli:register-module &quot;pgsql&quot;&nbsp;:real-name &quot;libpq.dll&quot;&nbsp;:connection-style&nbsp;:immediate)</p><p class=MsoNormal><o:p>&nbsp;</o:p></p><p class=MsoNormal>However, if i remove the folder’s path from my PATH environement variable and use the command&nbsp;:</p><p class=MsoNormal>(fli:register-module &quot;pgsql&quot;&nbsp;:real-name &quot;&lt;folder absolute path&gt;/libpq.dll&quot;&nbsp;:connection-style&nbsp;:immediate)<o:p></o:p></p><p class=MsoNormal>I receive an Error: Could not register handle for external module &quot;pgsql&quot;.</p><p class=MsoNormal><o:p>&nbsp;</o:p></p><p class=MsoNormal>Having to change the PATH environement variable of the systems my application will be deployed on… well they won’t let me do it. Is there a way to make it work without it&nbsp;?</p><p class=MsoNormal><o:p>&nbsp;</o:p></p><p class=MsoNormal>Note&nbsp;: for experiment sake, you can move libpq.dll to a separate folder and try registering it with it’s path… this will produce the same error. However, adding back the path of the folder containing the 4 other dlls to the PATH environement variable will make the registration work again.</p><p class=MsoNormal><o:p>&nbsp;</o:p></p><p class=MsoNormal>I suspect the problem is either in how Windows handle dll dependencies or how fli:register-module does it… or even in how the dependencies are defined in libpq.dll …</p><p class=MsoNormal><o:p>&nbsp;</o:p></p><p class=MsoNormal>Thank you for your help.</p><p class=MsoNormal><o:p>&nbsp;</o:p></p><p class=MsoNormal>Jérémie Daelen</p><p class=MsoNormal><span style='font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=MsoNormal>Configuration&nbsp;:<o:p></o:p></p><p class=MsoNormal>LispWorks 6.1.1 Enterprise Edition - 32 bits<o:p></o:p></p><p class=MsoNormal>Windows 10 - 64 bits</p></div></body></html>

               </article>
               <section class=tree>
                <article class=email>
                 <h1>Re: fli:register-module &amp; dll dependencies</h1>
                 <pre>
Jérémie Daelen &lt;jeremie.daelen@labage.be&gt writes:

&gt Hello,
&gt
&gt I’m trying to register a foreign language interface for the libpq.dll of PostgreSQL 9.5 – 32bits.
&gt
&gt This dll seems to depend on 4 other dlls: libeay32.dll, libiconv-2.dll, libintl-8.dll, ssleay32.dll.
&gt
&gt All dlls can be found together in the same folder &lt;PostgreSQL Folder&gt/9..1/bin.
&gt
&gt I managed to make it work by copying all 5 dlls to a seperate folder then adding this folder’s path
&gt to the PATH environement variable of my system. The command is then simply :
&gt
&gt (fli:register-module "pgsql" :real-name "libpq.dll" :connection-style :immediate)
&gt
&gt However, if i remove the folder’s path from my PATH environement variable and use the command :
&gt
&gt (fli:register-module "pgsql" :real-name "&lt;folder absolute path&gt/
&gt libpq.dll" :connection-style :immediate)

Hi,

Have you tried the following?

  (fli:register-module "&lt;folder absolute path&gt/libpq.dll")
  
That's how I did it with LWW 4.3.7.  Maybe they changed it in newer LWW?

If those DLL's are part of the package you deliver, you may also
want to use LW:LISP-IMAGE-NAME, MAKE-PATHNAME, and MERGE-PATHNAMES
to get the absolute paths of those DLL's, no matter where your users
may install your package.  

Best wishes,

-cph

_______________________________________________
Lisp Hug - the mailing list for LispWorks users
lisp-hug@lispworks.com
http://www.lispworks.com/support/lisp-hug.html


</pre>
                </article>
               </section>
               <section class=tree>
                <article class=email>
                 <h1>Re: fli:register-module &amp; dll dependencies</h1>
                 <pre>
cph &lt;cph@chi-square-works.com&gt writes:

&gt Jérémie Daelen &lt;jeremie.daelen@labage.be&gt writes:
&gt
&gt&gt Hello,
&gt&gt
&gt&gt I’m trying to register a foreign language interface for the libpq.dll of PostgreSQL 9.5 – 32bits.
&gt&gt
&gt&gt This dll seems to depend on 4 other dlls: libeay32.dll, libiconv-2.dll, libintl-8.dll, ssleay32.dll.
&gt&gt
&gt&gt All dlls can be found together in the same folder &lt;PostgreSQL Folder&gt/9.1/bin.
&gt&gt
&gt&gt I managed to make it work by copying all 5 dlls to a seperate folder then adding this folder’s path
&gt&gt to the PATH environement variable of my system. The command is then simply :
&gt&gt
&gt&gt (fli:register-module "pgsql" :real-name "libpq.dll" :connection-style :immediate)
&gt&gt
&gt&gt However, if i remove the folder’s path from my PATH environement variable and use the command :
&gt&gt
&gt&gt (fli:register-module "pgsql" :real-name "&lt;folder absolute path&gt/
&gt&gt libpq.dll" :connection-style :immediate)
&gt
&gt Hi,
&gt
&gt Have you tried the following?
&gt
&gt   (fli:register-module "&lt;folder absolute path&gt/libpq.dll")
                                                ^
I just did a quick check in my old code, those computed absolute
paths for my DLL's were of the form: "C:\\ABSOLUTE\\PATH\\SOME.DLL".
Maybe slash or backslash does matter.

Best wishes,

-cph

_______________________________________________
Lisp Hug - the mailing list for LispWorks users
lisp-hug@lispworks.com
http://www.lispworks.com/support/lisp-hug.html


</pre>
                </article>
               </section>
               <section class=tree>
                <article class=email>
                 <h1>Re: fli:register-module &amp; dll dependencies</h1>
                 <pre>
&gt&gt&gt
&gt&gt&gt (fli:register-module "pgsql" :real-name "&lt;folder absolute path&gt/
&gt&gt&gt libpq.dll" :connection-style :immediate)
&gt&gt
&gt&gt Hi,
&gt&gt
&gt&gt Have you tried the following?
&gt&gt
&gt&gt   (fli:register-module "&lt;folder absolute path&gt/libpq.dll")
&gt                                                 ^
&gt I just did a quick check in my old code, those computed absolute
&gt paths for my DLL's were of the form: "C:\\ABSOLUTE\\PATH\\SOME.DLL".
&gt Maybe slash or backslash does matter.
                               ^
                              NOT
Best,

-cph

_______________________________________________
Lisp Hug - the mailing list for LispWorks users
lisp-hug@lispworks.com
http://www.lispworks.com/support/lisp-hug.html


</pre>
                </article>
               </section>
               <section class=tree>
                <article class=email>
                 <h1>RE: fli:register-module &amp; dll dependencies</h1><html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" xmlns="http://www.w3.org/TR/REC-html40"><head><meta http-equiv=Content-Type content="text/html; charset=utf-8"><meta name=Generator content="Microsoft Word 15 (filtered medium)"><style><!--
/* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:#0563C1;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:#954F72;
	text-decoration:underline;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{mso-style-priority:34;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
..MsoChpDefault
	{mso-style-type:export-only;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:70.85pt 70.85pt 70.85pt 70.85pt;}
div.WordSection1
	{page:WordSection1;}
/* List Definitions */
@list l0
	{mso-list-id:717703637;
	mso-list-type:hybrid;
	mso-list-template-ids:1198285778 -1 67895321 67895323 67895311 67895321 67895323 67895311 67895321 67895323;}
@list l0:level1
	{mso-level-number-format:alpha-lower;
	mso-level-text:"%1\)";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l0:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level5
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l0:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level8
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l0:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l1
	{mso-list-id:1128277080;
	mso-list-type:hybrid;
	mso-list-template-ids:143566976 -1 67895321 67895323 67895311 67895321 67895323 67895311 67895321 67895323;}
@list l1:level1
	{mso-level-number-format:alpha-lower;
	mso-level-text:%1-;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l1:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l1:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l1:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l1:level5
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l1:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l1:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l1:level8
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l1:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
--></style></head><body lang=FR link="#0563C1" vlink="#954F72"><div class=WordSection1><p class=MsoNormal>&gt;&gt;&gt; (fli:register-module &quot;pgsql&quot; :real-name &quot;&lt;folder absolute path&gt;/</p><p class=MsoNormal>&gt;&gt;&gt; libpq.dll&quot; :connection-style :immediate)</p><p class=MsoNormal>&gt;&gt;<o:p>&nbsp;</o:p></p><p class=MsoNormal>&gt;&gt; Hi,</p><p class=MsoNormal>&gt;&gt;<o:p>&nbsp;</o:p></p><p class=MsoNormal>&gt;&gt; Have you tried the following?</p><p class=MsoNormal>&gt;&gt;<o:p>&nbsp;</o:p></p><p class=MsoNormal>&gt;&gt;   (fli:register-module &quot;&lt;folder absolute path&gt;/libpq.dll&quot;)</p><p class=MsoNormal>&gt;                                                 ^</p><p class=MsoNormal>&gt; I just did a quick check in my old code, those computed absolute</p><p class=MsoNormal>&gt; paths for my DLL's were of the form: &quot;C:\\ABSOLUTE\\PATH\\SOME.DLL&quot;.</p><p class=MsoNormal>&gt; Maybe slash or backslash does matter.</p><p class=MsoNormal>                               ^</p><p class=MsoNormal>                              NOT</p><p class=MsoNormal><o:p>&nbsp;</o:p></p><p class=MsoNormal>Thank you for helping me.</p><p class=MsoNormal><o:p>&nbsp;</o:p></p><p class=MsoNormal>I tried both relative and absolut path to no avail. I also tried building the absolute path using make-path name but it did not change anything. And indeed using double slaches our backslashes does not matter.</p><p class=MsoNormal><o:p>&nbsp;</o:p></p><p class=MsoNormal>I truly beleive this is linked to the fact that libpq.dll dépends on the other 4 <span lang=EN-US>dlls</span>… registering and connecting any other dll causes no problem. Here is a link to download all 5 dlls (if you do not trust this link, you can find them in the bin folder of any PostgreSQL – 32 bits install).</p><p class=MsoNormal><o:p>&nbsp;</o:p></p><p class=MsoNormal><a href="https://www.dropbox.com/sh/3b5tqipvc916zxz/AACaDsLqZj-eVc2_cnkLx2Aca?dl=0">https://www.dropbox.com/sh/3b5tqipvc916zxz/AACaDsLqZj-eVc2_cnkLx2Aca?dl=0</a></p><p class=MsoNormal><o:p>&nbsp;</o:p></p><p class=MsoNormal>I really see only 3 possibilities&nbsp;:</p><p class=MsoNormal>- DLL dependency is handled by LispWorks’ fli:register-module and do not use the&nbsp;:real-name parameter for them.</p><p class=MsoNormal>- DLL dependency is handled by the operating system and Windows 10 only look its system folder and PATH folders.</p><p class=MsoNormal>- DLL dependency is written in a Strange fashion Inside libpq.dll such that LispWorks or Windows cannot handle them.</p><p class=MsoNormal><o:p>&nbsp;</o:p></p><p class=MsoNormal>Best,</p><p class=MsoNormal><o:p>&nbsp;</o:p></p><p class=MsoNormal>Jérémie Daelen</p></div></body></html>

                </article>
               </section>
              </section>
             </div>
            </div>
            <footer class="d-flex justify-content-center">
             <div>
              Updated at: 2020-12-07 08:27 UTC
             </div>
            </footer>
           </body>
          </html>